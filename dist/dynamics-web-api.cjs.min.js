/*! dynamics-web-api v2.0.0-alpha.1 (c) 2023 Aleksandr Rogov */
"use strict";var ue=Object.create;var O=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var de=Object.getOwnPropertyNames;var ye=Object.getPrototypeOf,he=Object.prototype.hasOwnProperty;var P=(o,e)=>()=>(o&&(e=o(o=0)),e);var z=(o,e)=>{for(var t in e)O(o,t,{get:e[t],enumerable:!0})},X=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of de(e))!he.call(o,a)&&a!==t&&O(o,a,{get:()=>e[a],enumerable:!(n=me(e,a))||n.enumerable});return o};var M=(o,e,t)=>(t=o!=null?ue(ye(o)):{},X(e||!o||!o.__esModule?O(t,"default",{value:o,enumerable:!0}):t,o)),H=o=>X(O({},"__esModule",{value:!0}),o);function fe(){return j}function Q(){return fe().randomBytes(1)}var j,J=P(()=>{"use strict";j=require("crypto")});function ge(){return Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}var Re,A,c,W=P(()=>{"use strict";J();Re=4194304,A=class{static buildFunctionParameters(e){if(e){let n=Object.keys(e),a="",r="";for(var t=1;t<=n.length;t++){let l=n[t-1],s=e[l];s!==null&&(typeof s=="string"&&!s.startsWith("Microsoft.Dynamics.CRM")?s="'"+s+"'":typeof s=="object"&&(s=JSON.stringify(s)),t>1&&(a+=",",r+="&"),a+=l+"=@p"+t,r+="@p"+t+"="+s)}return"("+a+")?"+r}else return"()"}static getFetchXmlPagingCookie(e="",t=1){e=decodeURIComponent(decodeURIComponent(e));let n=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(n!=null){let a=parseInt(n[2]);return{cookie:n[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:a,nextPage:a+1}}else return{cookie:"",page:t,nextPage:t+1}}static convertToReferenceObject(e){let t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}static isNull(e){return typeof e>"u"||e==null}static generateUUID(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^Q()[0]&15>>e/4).toString(16))}static getXrmContext(){if(typeof GetGlobalContext<"u")return GetGlobalContext();if(typeof Xrm<"u"){if(!A.isNull(Xrm.Utility)&&!A.isNull(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!A.isNull(Xrm.Page)&&!A.isNull(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}static getXrmUtility(){return typeof Xrm<"u"?Xrm.Utility:null}static getClientUrl(){let t=A.getXrmContext().getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}static isObject(e){return typeof e=="object"&&!!e&&!Array.isArray(e)&&Object.prototype.toString.call(e)!=="[object Date]"}static copyObject(e,t){let n={};for(let a in e)e.hasOwnProperty(a)&&!(t!=null&&t.includes(a))&&(A.isObject(e[a])?n[a]=A.copyObject(e[a]):Array.isArray(e[a])?n[a]=e[a].slice():n[a]=e[a]);return n}static copyRequest(e,t=[]){t.includes("signal")||t.push("signal");let n=A.copyObject(e,t);return n.signal=e.signal,n}static setFileChunk(e,t,n,a){a=a||0;let r=a+n>t.length?t.length%n:n,l;if(typeof window>"u")l=t.slice(a,a+r);else{l=new Uint8Array(r);for(let s=0;s<r;s++)l[s]=t[a+s]}e.data=l,e.contentRange="bytes "+a+"-"+(a+r-1)+"/"+t.length}static convertToFileBuffer(e){if(typeof window>"u")return Buffer.from(e,"binary");{let n=new Uint8Array(e.length);for(var t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}}},c=A;c.isNodeEnv=ge,c.downloadChunkSize=Re});function C(o,e,t){throw new Error(t?`${o} requires a ${e} parameter to be of type ${t}.`:`${o} requires a ${e} parameter.`)}var i,D=P(()=>{"use strict";i=class{static handleErrorResponse(e){throw new Error(`Error: ${e.status}: ${e.message}`)}static parameterCheck(e,t,n,a){(typeof e>"u"||e===null||e==="")&&C(t,n,a)}static stringParameterCheck(e,t,n){typeof e!="string"&&C(t,n,"String")}static maxLengthStringParameterCheck(e,t,n,a){if(e&&e.length>a)throw new Error(`${n} has a ${a} character limit.`)}static arrayParameterCheck(e,t,n){e.constructor!==Array&&C(t,n,"Array")}static stringOrArrayParameterCheck(e,t,n){e.constructor!==Array&&typeof e!="string"&&C(t,n,"String or Array")}static numberParameterCheck(e,t,n){if(typeof e!="number"){if(typeof e=="string"&&e&&!isNaN(parseInt(e)))return;C(t,n,"Number")}}static batchIsEmpty(){return[new Error("Payload of the batch operation is empty. Please make that you have other operations in between startBatch() and executeBatch() to successfuly build a batch payload.")]}static handleHttpError(e,t){let n=new Error;return Object.keys(e).forEach(a=>{n[a]=e[a]}),t&&Object.keys(t).forEach(a=>{n[a]=t[a]}),n}static boolParameterCheck(e,t,n){typeof e!="boolean"&&C(t,n,"Boolean")}static guidParameterCheck(e,t,n){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch{C(t,n,"GUID String")}}static keyParameterCheck(e,t,n){try{i.stringParameterCheck(e,t,n);let a=/^{?([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})}?$/i.exec(e);if(a)return a[1];let r=e.split(",");if(r.length)for(let l=0;l<r.length;l++)r[l]=r[l].trim().replace(/"/g,"'"),/^[\w\d\_]+\=(.+)$/i.exec(r[l])[0];return r.join(",")}catch{C(t,n,"String representing GUID or Alternate Key")}}static callbackParameterCheck(e,t,n){typeof e!="function"&&C(t,n,"Function")}static throwBatchIncompatible(e,t){if(t)throw t=!1,new Error(e+" cannot be used in a BATCH request.")}static throwBatchNotStarted(e){if(!e)throw new Error("Batch operation has not been started. Please call a DynamicsWebApi.startBatch() function prior to calling DynamicsWebApi.executeBatch() to perform a batch request correctly.")}}});var v,S,K,x,Z=P(()=>{"use strict";K=class{},x=K;x.Prefer=(S=class{static get(e){return`${K.Prefer.IncludeAnnotations}="${e}"`}},S.ReturnRepresentation="return=representation",S.Annotations=(v=class{},v.AssociatedNavigationProperty="Microsoft.Dynamics.CRM.associatednavigationproperty",v.LookupLogicalName="Microsoft.Dynamics.CRM.lookuplogicalname",v.All="*",v.FormattedValue="OData.Community.Display.V1.FormattedValue",v.FetchXmlPagingCookie="Microsoft.Dynamics.CRM.fetchxmlpagingcookie",v),S.IncludeAnnotations="odata.include-annotations",S)});function G(o,e){if(typeof e=="string"){let t=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/.exec(e);if(t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],+t[6]))}return e}var Y=P(()=>{"use strict"});function V(o,e){let t=null;if(o.indexOf("@")!==-1){let n=o.split("@");switch(n[1]){case"odata.context":t="oDataContext";break;case"odata.count":t="oDataCount",e=e!=null?parseInt(e):0;break;case"odata.nextLink":t="oDataNextLink";break;case"odata.deltaLink":t="oDataDeltaLink";break;case x.Prefer.Annotations.FormattedValue:t=n[0]+"_Formatted";break;case x.Prefer.Annotations.AssociatedNavigationProperty:t=n[0]+"_NavigationProperty";break;case x.Prefer.Annotations.LookupLogicalName:t=n[0]+"_LogicalName";break}}return[t,e]}function B(o,e){if(e){if(e.isRef&&o["@odata.id"]!=null)return c.convertToReferenceObject(o);if(e.toCount)return V("@odata.count",o["@odata.count"])[1]||0}let t=Object.keys(o);for(let a=0;a<t.length;a++){let r=t[a];if(o[r]!=null)if(o[r].constructor===Array)for(var n=0;n<o[r].length;n++)o[r][n]=B(o[r][n]);else typeof o[r]=="object"&&B(o[r]);let l=V(r,o[r]);if(l[0]&&(o[l[0]]=l[1]),r.indexOf("_x002e_")!==-1){let s=r.split("_x002e_");if(!o.hasOwnProperty(s[0]))o[s[0]]={_dwaType:"alias"};else if(typeof o[s[0]]!="object"||typeof o[s[0]]=="object"&&!o[s[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!");o[s[0]][s[1]]=o[r],l=V(s[1],o[r]),l[0]&&(o[s[0]][l[0]]=l[1])}}return e&&e.hasOwnProperty("pageNumber")&&o["@"+x.Prefer.Annotations.FetchXmlPagingCookie]!=null&&(o.PagingInfo=c.getFetchXmlPagingCookie(o["@"+x.Prefer.Annotations.FetchXmlPagingCookie],e.pageNumber)),o}function Ce(o){let e={position:0},t={},n,a,r;do r=e.position,a=xe(o,e),n=Ae.exec(a),n!==null?t[n[1].toLowerCase()]=n[2]:e.position=r;while(a&&n);return t}function xe(o,e){return ke(o,e,`\r
`)}function ke(o,e,t){let n=e.position||0,a=o.length;if(t){if(a=o.indexOf(t,n),a===-1)return null;e.position=a+t.length}else e.position=a;return o.substring(n,a)}function ee(o,e,t=0){let n=o.substr(0,o.indexOf(`\r
`)),a=o.split(n);a.shift(),a.pop();let r=[];for(let l=0;l<a.length;l++){let s=a[l];if(s.indexOf("--changesetresponse_")>-1){s=s.trim();let p=s.substring(s.indexOf(`\r
`)+1).trim();r=r.concat(ee(p,e,t))}else{let p=/HTTP\/?\s*[\d.]*\s+(\d{3})\s+([\w\s]*)$/gm.exec(s),u=parseInt(p[1]),f=p[2].trim(),d=s.substring(s.indexOf("{"),s.lastIndexOf("}")+1);if(d){let m=B(JSON.parse(d,G),e[t]);if(u>=400){let b=Ce(s.substring(s.indexOf(p[0])+p[0].length+1,s.indexOf("{")));r.push(i.handleHttpError(m,{status:u,statusText:f,statusMessage:f,headers:b}))}else r.push(m)}else if(/Content-Type: text\/plain/i.test(s)){let m=/\w+$/gi.exec(s.trim()),b=m&&m.length?m[0]:void 0;r.push(isNaN(Number(b))?b:Number(b))}else if(e.length&&e[t]&&e[t].hasOwnProperty("valueIfEmpty"))r.push(e[t].valueIfEmpty);else{let m=/OData-EntityId.+/i.exec(s);if(m&&m.length){let b=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(m[0]);r.push(b?b[1]:void 0)}else r.push(void 0)}}t++}return r}function Pe(o){return typeof process<"u"?Buffer.from(o,"base64").toString("binary"):typeof window<"u"?window.atob(o):null}function De(o,e,t){let n=o;t.hasOwnProperty("parse")&&(n=JSON.parse(n).value,n=Pe(n));var a={value:n};return e["x-ms-file-name"]&&(a.fileName=e["x-ms-file-name"]),e["x-ms-file-size"]&&(a.fileSize=parseInt(e["x-ms-file-size"])),w(e,"Location")&&(a.location=U(e,"Location")),a}function w(o,e){return o.hasOwnProperty(e)||o.hasOwnProperty(e.toLowerCase())}function U(o,e){return o[e]?o[e]:o[e.toLowerCase()]}function L(o,e,t){let n;if(o.length)if(o.indexOf("--batchresponse_")>-1){let a=ee(o,t);n=t.length===1&&t[0].convertedToBatch?a[0]:a}else w(e,"Content-Disposition")?n=De(o,e,t[0]):U(e,"Content-Type").startsWith("application/json")?n=B(JSON.parse(o,G),t[0]):n=isNaN(Number(o))?o:Number(o);else if(t.length&&t[0].hasOwnProperty("valueIfEmpty"))n=t[0].valueIfEmpty;else if(w(e,"OData-EntityId")){let a=U(e,"OData-EntityId"),r=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(a);r&&(n=r[1])}else w(e,"Location")&&(n={location:U(e,"Location")},e["x-ms-chunk-size"]&&(n.chunkSize=parseInt(e["x-ms-chunk-size"])));return n}var Ae,te=P(()=>{"use strict";Z();W();D();Y();Ae=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/});var oe={};z(oe,{executeRequest:()=>ve});function ve(o){var b;let e=o.data,t=o.additionalHeaders,n=o.responseParams,a=o.successCallback,r=o.errorCallback,l=o.abortSignal,s={};e&&(s["Content-Type"]=t["Content-Type"],s["Content-Length"]=e.length,delete t["Content-Type"]);for(let y in t)s[y]=t[y];let p=F.parse(o.uri),u=((b=p.protocol)==null?void 0:b.slice(0,-1))||"https",f=u==="http"?ne:ae,d={hostname:p.hostname,port:p.port,path:p.path,method:o.method,timeout:o.timeout||0,headers:s,signal:l};if(!o.proxy&&process.env[`${u}_proxy`]&&(o.proxy={url:process.env[`${u}_proxy`]}),d.agent=Te(o,u),o.proxy){let y=F.parse(o.proxy.url).host;y&&(s.host=y)}let m=f.request(d,function(y){let I="";y.setEncoding("utf8"),y.on("data",function(k){I+=k}),y.on("end",function(){switch(y.statusCode){case 200:case 201:case 204:case 206:case 304:{let pe={data:L(I,y.headers,n[o.requestId]),headers:y.headers,status:y.statusCode};delete n[o.requestId],a(pe);break}default:let $;try{var k=L(I,y.headers,n[o.requestId]);if(Array.isArray(k)){delete n[o.requestId],r(k);break}$=k.hasOwnProperty("error")&&k.error?k.error:{message:k.Message}}catch{I.length>0?$={message:I}:$={message:"Unexpected Error"}}delete n[o.requestId],r(i.handleHttpError($,{status:y.statusCode,statusText:"",statusMessage:y.statusMessage,headers:y.headers}));break}})});d.timeout&&m.setTimeout(d.timeout,function(){delete n[o.requestId],m.destroy()}),m.on("error",function(y){delete n[o.requestId],r(y)}),e&&m.write(e),m.end()}var ne,ae,F,ie,re,q,Te,se=P(()=>{"use strict";ne=M(require("http")),ae=M(require("https")),F=M(require("url")),ie=require("http-proxy-agent"),re=require("https-proxy-agent");D();te();q={},Te=(o,e)=>{let t=e==="http",n=o.proxy,a=n?n.url:e;if(!q[a])if(n){let r=F.parse(n.url),l=t?ie.HttpProxyAgent:re.HttpsProxyAgent,s={host:r.hostname,port:r.port,protocol:r.protocol};n.auth?s.auth=n.auth.username+":"+n.auth.password:r.auth&&(s.auth=r.auth),q[a]=new l(s)}else{let r=t?ne:ae;q[a]=new r.Agent({keepAlive:!0,maxSockets:1/0})}return q[a]}});var Ne={};z(Ne,{DynamicsWebApi:()=>E});module.exports=H(Ne);W();D();var be=(o,e)=>(o||(o=c.getClientUrl()),`${o}/api/${e.path}/v${e.version}/`),_=(o,e,t)=>{let n=t[e];o!=null&&o.version&&(i.stringParameterCheck(o.version,"DynamicsWebApi.setConfig",`config.${e}.version`),n.version=o.version),o!=null&&o.path&&(i.stringParameterCheck(o.path,"DynamicsWebApi.setConfig",`config.${e}.path`),n.path=o.path),n.url=be(t.serverUrl,n)},T=class{static merge(e,t){t!=null&&t.serverUrl&&(i.stringParameterCheck(t.serverUrl,"DynamicsWebApi.setConfig","config.serverUrl"),e.serverUrl=t.serverUrl),_(t==null?void 0:t.dataApi,"dataApi",e),_(t==null?void 0:t.searchApi,"searchApi",e),t!=null&&t.impersonate&&(e.impersonate=i.guidParameterCheck(t.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),t!=null&&t.impersonateAAD&&(e.impersonateAAD=i.guidParameterCheck(t.impersonateAAD,"DynamicsWebApi.setConfig","config.impersonateAAD")),t!=null&&t.onTokenRefresh&&(i.callbackParameterCheck(t.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),e.onTokenRefresh=t.onTokenRefresh),t!=null&&t.includeAnnotations&&(i.stringParameterCheck(t.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),e.includeAnnotations=t.includeAnnotations),t!=null&&t.timeout&&(i.numberParameterCheck(t.timeout,"DynamicsWebApi.setConfig","config.timeout"),e.timeout=t.timeout),t!=null&&t.maxPageSize&&(i.numberParameterCheck(t.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),e.maxPageSize=t.maxPageSize),t!=null&&t.returnRepresentation&&(i.boolParameterCheck(t.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),e.returnRepresentation=t.returnRepresentation),t!=null&&t.useEntityNames&&(i.boolParameterCheck(t.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),e.useEntityNames=t.useEntityNames),t!=null&&t.proxy&&(i.parameterCheck(t.proxy,"DynamicsWebApi.setConfig","config.proxy"),t.proxy.url&&(i.stringParameterCheck(t.proxy.url,"DynamicsWebApi.setConfig","config.proxy.url"),t.proxy.auth&&(i.parameterCheck(t.proxy.auth,"DynamicsWebApi.setConfig","config.proxy.auth"),i.stringParameterCheck(t.proxy.auth.username,"DynamicsWebApi.setConfig","config.proxy.auth.username"),i.stringParameterCheck(t.proxy.auth.password,"DynamicsWebApi.setConfig","config.proxy.auth.password"))),e.proxy=t.proxy)}static default(){return{serverUrl:null,impersonate:null,impersonateAAD:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null,proxy:null,dataApi:{path:"data",version:"9.2",url:""},searchApi:{path:"search",version:"1.0",url:""}}}};T.mergeApiConfigs=_;W();D();W();W();D();var R=class{static compose(e,t){if(e.path=e.path||"",e.functionName=e.functionName||"",e.url)i.stringParameterCheck(e.url,`DynamicsWebApi.${e.functionName}`,"request.url"),e.path=e.url.replace(t.dataApi.url,""),e.path=R.composeUrl(e,t,e.path);else if(!e._isUnboundRequest&&!e.collection&&i.parameterCheck(e.collection,`DynamicsWebApi.${e.functionName}`,"request.collection"),e.collection!=null&&(i.stringParameterCheck(e.collection,`DynamicsWebApi.${e.functionName}`,"request.collection"),e.path=e.collection,e.contentId&&(i.stringParameterCheck(e.contentId,`DynamicsWebApi.${e.functionName}`,"request.contentId"),e.contentId.startsWith("$")&&(e.path=`${e.contentId}/${e.path}`)),e.key&&(e.key=i.keyParameterCheck(e.key,`DynamicsWebApi.${e.functionName}`,"request.key"),e.path+=`(${e.key})`)),e._additionalUrl&&(e.path&&(e.path+="/"),e.path+=e._additionalUrl),e.path=R.composeUrl(e,t,e.path),e.fetchXml){i.stringParameterCheck(e.fetchXml,`DynamicsWebApi.${e.functionName}`,"request.fetchXml");let n=e.path.indexOf("?")===-1?"?":"&";e.path+=`${n}fetchXml=${encodeURIComponent(e.fetchXml)}`}return e.hasOwnProperty("async")&&e.async!=null?i.boolParameterCheck(e.async,`DynamicsWebApi.${e.functionName}`,"request.async"):e.async=!0,e.headers=R.composeHeaders(e,t),e}static composeUrl(e,t,n="",a="&"){var l,s,p;let r=[];if(e){if(e.navigationProperty){if(i.stringParameterCheck(e.navigationProperty,`DynamicsWebApi.${e.functionName}`,"request.navigationProperty"),n+="/"+e.navigationProperty,e.navigationPropertyKey){let u=i.keyParameterCheck(e.navigationPropertyKey,`DynamicsWebApi.${e.functionName}`,"request.navigationPropertyKey");n+="("+u+")"}e.navigationProperty==="Attributes"&&e.metadataAttributeType&&(i.stringParameterCheck(e.metadataAttributeType,`DynamicsWebApi.${e.functionName}`,"request.metadataAttributeType"),n+="/"+e.metadataAttributeType)}if((l=e.select)!=null&&l.length&&(i.arrayParameterCheck(e.select,`DynamicsWebApi.${e.functionName}`,"request.select"),e.functionName=="retrieve"&&e.select.length==1&&e.select[0].endsWith("/$ref")?n+="/"+e.select[0]:(e.select[0].startsWith("/")&&e.functionName=="retrieve"&&(e.navigationProperty==null?n+=e.select.shift():e.select.shift()),e.select.length&&r.push("$select="+e.select.join(",")))),e.filter){i.stringParameterCheck(e.filter,`DynamicsWebApi.${e.functionName}`,"request.filter");let u=/[^"']{([\w\d]{8}[-]?(?:[\w\d]{4}[-]?){3}[\w\d]{12})}(?:[^"']|$)/g,f=e.filter,d=null;for(;(d=u.exec(f))!==null;){d.index===u.lastIndex&&u.lastIndex++;let m=d[0].endsWith(")")?")":" ";f=f.replace(d[0]," "+d[1]+m)}r.push("$filter="+encodeURIComponent(f))}if(e.fieldName&&(i.stringParameterCheck(e.fieldName,`DynamicsWebApi.${e.functionName}`,"request.fieldName"),n+="/"+e.fieldName),e.savedQuery&&r.push("savedQuery="+i.guidParameterCheck(e.savedQuery,`DynamicsWebApi.${e.functionName}`,"request.savedQuery")),e.userQuery&&r.push("userQuery="+i.guidParameterCheck(e.userQuery,`DynamicsWebApi.${e.functionName}`,"request.userQuery")),e.apply&&(i.stringParameterCheck(e.apply,`DynamicsWebApi.${e.functionName}`,"request.apply"),r.push("$apply="+e.apply)),e.count&&(i.boolParameterCheck(e.count,`DynamicsWebApi.${e.functionName}`,"request.count"),r.push("$count="+e.count)),e.top&&e.top>0&&(i.numberParameterCheck(e.top,`DynamicsWebApi.${e.functionName}`,"request.top"),r.push("$top="+e.top)),e.orderBy!=null&&e.orderBy.length&&(i.arrayParameterCheck(e.orderBy,`DynamicsWebApi.${e.functionName}`,"request.orderBy"),r.push("$orderby="+e.orderBy.join(","))),e.partitionId&&(i.stringParameterCheck(e.partitionId,`DynamicsWebApi.${e.functionName}`,"request.partitionId"),r.push("partitionid='"+e.partitionId+"'")),e.downloadSize&&(i.stringParameterCheck(e.downloadSize,`DynamicsWebApi.${e.functionName}`,"request.downloadSize"),r.push("size="+e.downloadSize)),(s=e.queryParams)!=null&&s.length&&(i.arrayParameterCheck(e.queryParams,`DynamicsWebApi.${e.functionName}`,"request.queryParams"),r.push(e.queryParams.join("&"))),e.fileName&&(i.stringParameterCheck(e.fileName,`DynamicsWebApi.${e.functionName}`,"request.fileName"),r.push("x-ms-file-name="+e.fileName)),e.data&&i.parameterCheck(e.data,`DynamicsWebApi.${e.functionName}`,"request.data"),e.isBatch&&i.boolParameterCheck(e.isBatch,`DynamicsWebApi.${e.functionName}`,"request.isBatch"),e.timeout&&i.numberParameterCheck(e.timeout,`DynamicsWebApi.${e.functionName}`,"request.timeout"),(p=e.expand)!=null&&p.length)if(i.stringOrArrayParameterCheck(e.expand,`DynamicsWebApi.${e.functionName}`,"request.expand"),typeof e.expand=="string")r.push("$expand="+e.expand);else{let u=[];for(let f=0;f<e.expand.length;f++)if(e.expand[f].property){let d=e.expand[f];d.functionName=`${e.functionName} $expand`;let m=R.composeUrl(d,t,"",";");m&&(m=`(${m.substr(1)})`),u.push(e.expand[f].property+m)}u.length&&r.push("$expand="+u.join(","))}}return r.length?n+"?"+r.join(a):n}static composeHeaders(e,t){let n={},a=R.composePreferHeader(e,t);if(a.length&&(n.Prefer=a),e.collection==="$metadata"&&(n.Accept="application/xml"),e.transferMode&&(n["x-ms-transfer-mode"]=e.transferMode),e.ifmatch!=null&&e.ifnonematch!=null)throw new Error(`DynamicsWebApi.${e.functionName}. Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.`);return e.ifmatch&&(i.stringParameterCheck(e.ifmatch,`DynamicsWebApi.${e.functionName}`,"request.ifmatch"),n["If-Match"]=e.ifmatch),e.ifnonematch&&(i.stringParameterCheck(e.ifnonematch,`DynamicsWebApi.${e.functionName}`,"request.ifnonematch"),n["If-None-Match"]=e.ifnonematch),e.impersonate&&(i.stringParameterCheck(e.impersonate,`DynamicsWebApi.${e.functionName}`,"request.impersonate"),n.MSCRMCallerID=i.guidParameterCheck(e.impersonate,`DynamicsWebApi.${e.functionName}`,"request.impersonate")),e.impersonateAAD&&(i.stringParameterCheck(e.impersonateAAD,`DynamicsWebApi.${e.functionName}`,"request.impersonateAAD"),n.CallerObjectId=i.guidParameterCheck(e.impersonateAAD,`DynamicsWebApi.${e.functionName}`,"request.impersonateAAD")),e.token&&(i.stringParameterCheck(e.token,`DynamicsWebApi.${e.functionName}`,"request.token"),n.Authorization="Bearer "+e.token),e.duplicateDetection&&(i.boolParameterCheck(e.duplicateDetection,`DynamicsWebApi.${e.functionName}`,"request.duplicateDetection"),n["MSCRM.SuppressDuplicateDetection"]="false"),e.bypassCustomPluginExecution&&(i.boolParameterCheck(e.bypassCustomPluginExecution,`DynamicsWebApi.${e.functionName}`,"request.bypassCustomPluginExecution"),n["MSCRM.BypassCustomPluginExecution"]="true"),e.noCache&&(i.boolParameterCheck(e.noCache,`DynamicsWebApi.${e.functionName}`,"request.noCache"),n["Cache-Control"]="no-cache"),e.mergeLabels&&(i.boolParameterCheck(e.mergeLabels,`DynamicsWebApi.${e.functionName}`,"request.mergeLabels"),n["MSCRM.MergeLabels"]="true"),e.contentId&&(i.stringParameterCheck(e.contentId,`DynamicsWebApi.${e.functionName}`,"request.contentId"),e.contentId.startsWith("$")||(n["Content-ID"]=e.contentId)),e.contentRange&&(i.stringParameterCheck(e.contentRange,`DynamicsWebApi.${e.functionName}`,"request.contentRange"),n["Content-Range"]=e.contentRange),e.range&&(i.stringParameterCheck(e.range,`DynamicsWebApi.${e.functionName}`,"request.range"),n.Range=e.range),n}static composePreferHeader(e,t){let n=e.returnRepresentation,a=e.includeAnnotations,r=e.maxPageSize,l=e.trackChanges,s=[];if(e.prefer&&e.prefer.length){i.stringOrArrayParameterCheck(e.prefer,`DynamicsWebApi.${e.functionName}`,"request.prefer"),typeof e.prefer=="string"&&(s=e.prefer.split(","));for(let p in s){let u=s[p].trim();u==="return=representation"?n=!0:u.indexOf("odata.include-annotations=")>-1?a=u.replace("odata.include-annotations=","").replace(/"/g,""):u.startsWith("odata.maxpagesize=")?r=Number(u.replace("odata.maxpagesize=","").replace(/"/g,""))||0:u.indexOf("odata.track-changes")>-1&&(l=!0)}}return s=[],t&&(n==null&&(n=t.returnRepresentation),a=a||t.includeAnnotations,r=r||t.maxPageSize),n&&(i.boolParameterCheck(n,`DynamicsWebApi.${e.functionName}`,"request.returnRepresentation"),s.push("return=representation")),a&&(i.stringParameterCheck(a,`DynamicsWebApi.${e.functionName}`,"request.includeAnnotations"),s.push(`odata.include-annotations="${a}"`)),r&&r>0&&(i.numberParameterCheck(r,`DynamicsWebApi.${e.functionName}`,"request.maxPageSize"),s.push("odata.maxpagesize="+r)),l&&(i.boolParameterCheck(l,`DynamicsWebApi.${e.functionName}`,"request.trackChanges"),s.push("odata.track-changes")),s.join(",")}static convertToBatch(e,t){let n=`dwa_batch_${c.generateUUID()}`,a=[],r=null,l=1e5;e.forEach(p=>{var d;p.functionName="executeBatch";let u=p.method==="GET";if(u&&r&&(a.push(`
--${r}--`),r=null,l=1e5),r||(a.push(`
--${n}`),u||(r=`changeset_${c.generateUUID()}`,a.push("Content-Type: multipart/mixed;boundary="+r))),u||a.push(`
--${r}`),a.push("Content-Type: application/http"),a.push("Content-Transfer-Encoding: binary"),!u){let m=p.headers.hasOwnProperty("Content-ID")?p.headers["Content-ID"]:++l;a.push(`Content-ID: ${m}`)}(d=p.path)!=null&&d.startsWith("$")?a.push(`
${p.method} ${p.path} HTTP/1.1`):a.push(`
${p.method} ${t.dataApi.url}${p.path} HTTP/1.1`),u?a.push("Accept: application/json"):a.push("Content-Type: application/json");for(let m in p.headers)m==="Authorization"||m==="Content-ID"||a.push(`${m}: ${p.headers[m]}`);let f=p.data;!u&&f&&a.push(`
${R.processData(f,t)}`)}),r&&a.push(`
--${r}--`),a.push(`
--${n}--`);let s=R.setStandardHeaders();return s["Content-Type"]=`multipart/mixed;boundary=${n}`,{headers:s,body:a.join(`
`)}}static findCollectionName(e){let t=null;if(!c.isNull(R.entityNames)&&(t=R.entityNames[e],c.isNull(t))){for(let n in R.entityNames)if(R.entityNames[n]===e)return e}return t}static processData(e,t){let n;if(e){if(e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array)return e;n=JSON.stringify(e,(a,r)=>{if(a.endsWith("@odata.bind")||a.endsWith("@odata.id")){if(typeof r=="string"&&!r.startsWith("$")){if(/\(\{[\w\d-]+\}\)/g.test(r)&&(r=r.replace(/(.+)\(\{([\w\d-]+)\}\)/g,"$1($2)")),t.useEntityNames){let l=/([\w_]+)(\([\d\w-]+\))$/,s=l.exec(r);if(s&&s.length>2){let p=R.findCollectionName(s[1]);c.isNull(p)||(r=r.replace(l,p+"$2"))}}r.startsWith(t.dataApi.url)||(a.endsWith("@odata.bind")?r.startsWith("/")||(r="/"+r):r=t.dataApi.url+r.replace(/^\//,""))}}else(a.startsWith("oData")||a.endsWith("_Formatted")||a.endsWith("_NavigationProperty")||a.endsWith("_LogicalName"))&&(r=void 0);return r}),n=n.replace(/[\u007F-\uFFFF]/g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).substr(-4)})}return n}static setStandardHeaders(e={}){return e.Accept||(e.Accept="application/json"),e["OData-MaxVersion"]="4.0",e["OData-Version"]="4.0",e["Content-Type"]=e["Content-Range"]?"application/octet-stream":"application/json; charset=utf-8",e}},g=R;g.entityNames=null;D();function ce(o){return(se(),H(oe)).executeRequest(o)}var h=class{static addResponseParams(e,t){h._responseParseParams[e]?h._responseParseParams[e].push(t):h._responseParseParams[e]=[t]}static addRequestToBatchCollection(e,t){h._batchRequestCollection[e]?h._batchRequestCollection[e].push(t):h._batchRequestCollection[e]=[t]}static sendRequest(e,t,n,a){e.headers=e.headers||{},e.responseParameters=e.responseParameters||{},e.requestId=e.requestId||c.generateUUID(),h.addResponseParams(e.requestId,e.responseParameters);let r=null,l=e.responseParameters!=null&&e.responseParameters.convertedToBatch;if(e.path==="$batch"&&!l){let p=h._batchRequestCollection[e.requestId];p||a(i.batchIsEmpty());let u=g.convertToBatch(p,t);r=u.body,e.headers={...u.headers,...e.headers},delete h._batchRequestCollection[e.requestId]}else r=l?e.data:g.processData(e.data,t),l||(e.headers=g.setStandardHeaders(e.headers));t.impersonate&&!e.headers.MSCRMCallerID&&(e.headers.MSCRMCallerID=t.impersonate),t.impersonateAAD&&!e.headers.CallerObjectId&&(e.headers.CallerObjectId=t.impersonateAAD);let s=function(p){p&&(e.headers||(e.headers={}),e.headers.Authorization="Bearer "+(p.hasOwnProperty("accessToken")?p.accessToken:p));let u=e.apiConfig?e.apiConfig.url:t.dataApi.url;ce({method:e.method,uri:u+e.path,data:r,additionalHeaders:e.headers,responseParams:h._responseParseParams,successCallback:n,errorCallback:a,isAsync:e.async,timeout:e.timeout||t.timeout,proxy:t.proxy,requestId:e.requestId,abortSignal:e.signal})};t.onTokenRefresh&&(!e.headers||e.headers&&!e.headers.Authorization)?t.onTokenRefresh(s):s()}static _getCollectionNames(e,t,n,a){if(!c.isNull(g.entityNames))n(g.findCollectionName(e)||e);else{let r=function(p){g.entityNames={};for(var u=0;u<p.data.value.length;u++)g.entityNames[p.data.value[u].LogicalName]=p.data.value[u].EntitySetName;n(g.findCollectionName(e)||e)},l=function(p){a({message:"Unable to fetch EntityDefinitions. Error: "+p.message})},s=g.compose({method:"GET",collection:"EntityDefinitions",select:["EntitySetName","LogicalName"],noCache:!0,functionName:"retrieveMultiple"},t);h.sendRequest(s,t,r,l)}}static _isEntityNameException(e){return["$metadata","EntityDefinitions","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions","query","suggest","autocomplete"].indexOf(e)>-1}static _checkCollectionName(e,t,n,a){if(!e||h._isEntityNameException(e)){n(e);return}if(e=e.toLowerCase(),!t.useEntityNames){n(e);return}try{h._getCollectionNames(e,t,n,a)}catch(r){a({message:"Unable to fetch Collection Names. Error: "+r.message})}}static makeRequest(e,t,n,a){e.responseParameters=e.responseParameters||{},e.isBatch?(e=g.compose(e,t),h.addResponseParams(e.requestId,e.responseParameters),h.addRequestToBatchCollection(e.requestId,e)):h._checkCollectionName(e.collection,t,r=>{if(e.collection=r,e=g.compose(e,t),e.responseParameters.convertedToBatch=!1,e.path.length>2e3){let l=g.convertToBatch([e],t);e.method="POST",e.path="$batch",e.data=l.body,e.headers=l.headers,e.responseParameters.convertedToBatch=!0}h.sendRequest(e,t,n,a)},a)}static _clearEntityNames(){g.entityNames=null}static getCollectionName(e){return g.findCollectionName(e)}},N=h;N._batchRequestCollection={},N._responseParseParams={};var E=class{constructor(e){this._config=T.default();this._isBatch=!1;this._batchRequestId=null;this.setConfig=e=>T.merge(this._config,e);this._makeRequest=e=>(e.isBatch=this._isBatch,e.requestId=this._batchRequestId,new Promise((t,n)=>{N.makeRequest(e,this._config,t,n)}));this.create=e=>{i.parameterCheck(e,"DynamicsWebApi.create","request");let t;return e.functionName?t=e:(t=c.copyRequest(e),t.functionName="create"),t.method="POST",this._makeRequest(t).then(function(n){return n.data})};this.retrieve=e=>{var n;i.parameterCheck(e,"DynamicsWebApi.retrieve","request");let t;return e.functionName?t=e:(t=c.copyRequest(e),t.functionName="retrieve"),t.method="GET",t.responseParameters={isRef:((n=t.select)==null?void 0:n.length)===1&&t.select[0].endsWith("/$ref")},this._makeRequest(t).then(function(a){return a.data})};this.update=e=>{i.parameterCheck(e,"DynamicsWebApi.update","request");let t;e.functionName?t=e:(t=c.copyRequest(e),t.functionName="update"),t.method||(t.method=/EntityDefinitions|RelationshipDefinitions|GlobalOptionSetDefinitions/.test(t.collection||"")?"PUT":"PATCH"),t.responseParameters={valueIfEmpty:!0},t.ifmatch==null&&(t.ifmatch="*");let n=t.ifmatch;return this._makeRequest(t).then(function(a){return a.data}).catch(function(a){if(n&&a.status===412)return!1;throw a})};this.updateSingleProperty=e=>{i.parameterCheck(e,"DynamicsWebApi.updateSingleProperty","request"),i.parameterCheck(e.fieldValuePair,"DynamicsWebApi.updateSingleProperty","request.fieldValuePair");var t=Object.keys(e.fieldValuePair)[0],n=e.fieldValuePair[t];let a=c.copyRequest(e);return a.navigationProperty=t,a.data={value:n},a.functionName="updateSingleProperty",a.method="PUT",delete a.fieldValuePair,this._makeRequest(a).then(function(r){return r.data})};this.deleteRecord=e=>{i.parameterCheck(e,"DynamicsWebApi.deleteRecord","request");let t;e.functionName?t=e:(t=c.copyRequest(e),t.functionName="deleteRecord"),t.method="DELETE",t.responseParameters={valueIfEmpty:!0};let n=t.ifmatch;return this._makeRequest(t).then(function(a){return a.data}).catch(function(a){if(n&&a.status===412)return!1;throw a})};this.upsert=e=>{i.parameterCheck(e,"DynamicsWebApi.upsert","request");let t=c.copyRequest(e);t.method="PATCH",t.functionName="upsert";let n=t.ifnonematch,a=t.ifmatch;return this._makeRequest(t).then(function(r){return r.data}).catch(function(r){if(!(n&&r.status===412)&&!(a&&r.status===404))throw r})};this._uploadFileChunk=(e,t,n,a=0)=>(c.setFileChunk(e,t,n,a),this._makeRequest(e).then(()=>{if(a+=n,a<=t.length)return this._uploadFileChunk(e,t,n,a)}));this.uploadFile=e=>{i.throwBatchIncompatible("DynamicsWebApi.uploadFile",this._isBatch),i.parameterCheck(e,"DynamicsWebApi.uploadFile","request");let t=c.copyRequest(e,["data"]);return t.method="PATCH",t.functionName="uploadFile",t.transferMode="chunked",this._makeRequest(t).then(n=>(t.url=n.data.location,delete t.transferMode,delete t.fieldName,delete t.fileName,this._uploadFileChunk(t,e.data,n.data.chunkSize)))};this._downloadFileChunk=(e,t=0,n="")=>(e.range="bytes="+t+"-"+(t+c.downloadChunkSize-1),e.downloadSize="full",this._makeRequest(e).then(a=>(e.url=a.data.location,n+=a.data.value,t+=c.downloadChunkSize,t<=a.data.fileSize?this._downloadFileChunk(e,t,n):{fileName:a.data.fileName,fileSize:a.data.fileSize,data:c.convertToFileBuffer(n)})));this.downloadFile=e=>{i.throwBatchIncompatible("DynamicsWebApi.downloadFile",this._isBatch),i.parameterCheck(e,"DynamicsWebApi.downloadFile","request");let t=c.copyRequest(e);return t.method="GET",t.functionName="downloadFile",t.responseParameters={parse:!0},this._downloadFileChunk(t)};this.retrieveMultiple=(e,t)=>{i.parameterCheck(e,"DynamicsWebApi.retrieveMultiple","request");let n;return e.functionName?n=e:(n=c.copyRequest(e),n.functionName="retrieveMultiple"),n.method="GET",t&&(i.stringParameterCheck(t,"DynamicsWebApi.retrieveMultiple","nextPageLink"),n.url=t),this._makeRequest(n).then(function(a){return a.data})};this._retrieveAllRequest=(e,t,n=[])=>this.retrieveMultiple(e,t).then(a=>{n=n.concat(a.value);let r=a.oDataNextLink;if(r)return this._retrieveAllRequest(e,r,n);let l={value:n};return a.oDataDeltaLink&&(l["@odata.deltaLink"]=a.oDataDeltaLink,l.oDataDeltaLink=a.oDataDeltaLink),l});this.retrieveAll=e=>(i.throwBatchIncompatible("DynamicsWebApi.retrieveAll",this._isBatch),this._retrieveAllRequest(e));this.count=e=>{var n;i.parameterCheck(e,"DynamicsWebApi.count","request");let t=c.copyRequest(e);return t.method="GET",t.functionName="count",(n=t.filter)!=null&&n.length?t.count=!0:t.navigationProperty="$count",t.responseParameters={toCount:t.count},this._makeRequest(t).then(function(a){return a.data})};this.countAll=e=>(i.throwBatchIncompatible("DynamicsWebApi.countAll",this._isBatch),i.parameterCheck(e,"DynamicsWebApi.countAll","request"),this._retrieveAllRequest(e).then(function(t){return t&&t.value?t.value.length:0}));this.fetch=e=>{i.parameterCheck(e,"DynamicsWebApi.fetch","request");let t=c.copyRequest(e);if(t.method="GET",t.functionName="fetch",i.stringParameterCheck(t.fetchXml,"DynamicsWebApi.fetch","request.fetchXml"),t.fetchXml&&!/^<fetch.+top=/.test(t.fetchXml)){let n="";/^<fetch.+page=/.test(t.fetchXml)||(t.pageNumber=t.pageNumber||1,i.numberParameterCheck(t.pageNumber,"DynamicsWebApi.fetch","request.pageNumber"),n=`$1 page="${t.pageNumber}"`),t.pagingCookie!=null&&(i.stringParameterCheck(t.pagingCookie,"DynamicsWebApi.fetch","request.pagingCookie"),n+=` paging-cookie="${t.pagingCookie}"`),n&&(t.fetchXml=t.fetchXml.replace(/^(<fetch)/,n))}return t.responseParameters={pageNumber:t.pageNumber},this._makeRequest(t).then(function(n){return n.data})};this.fetchAll=e=>{i.parameterCheck(e,"DynamicsWebApi.fetchAll","request");let t=(n,a=[])=>this.fetch(n).then(function(r){return a=a.concat(r.value),r.PagingInfo?(n.pageNumber=r.PagingInfo.nextPage,n.pagingCookie=r.PagingInfo.cookie,t(n,a)):{value:a}});return i.throwBatchIncompatible("DynamicsWebApi.fetchAll",this._isBatch),t(e)};this.associate=e=>{i.parameterCheck(e,"DynamicsWebApi.associate","request");let t=c.copyRequest(e);t.method="POST",t.functionName="associate",i.stringParameterCheck(e.relatedCollection,"DynamicsWebApi.associate","request.relatedcollection"),i.stringParameterCheck(e.relationshipName,"DynamicsWebApi.associate","request.relationshipName");let n=i.keyParameterCheck(e.primaryKey,"DynamicsWebApi.associate","request.primaryKey"),a=i.keyParameterCheck(e.relatedKey,"DynamicsWebApi.associate","request.relatedKey");return t.navigationProperty=e.relationshipName+"/$ref",t.key=n,t.data={"@odata.id":`${e.relatedCollection}(${a})`},this._makeRequest(t).then(()=>{})};this.disassociate=e=>{i.parameterCheck(e,"DynamicsWebApi.disassociate","request");let t=c.copyRequest(e);t.method="DELETE",t.functionName="disassociate",i.stringParameterCheck(e.relationshipName,"DynamicsWebApi.disassociate","request.relationshipName");let n=i.keyParameterCheck(e.primaryKey,"DynamicsWebApi.disassociate","request.primaryKey"),a=i.keyParameterCheck(e.relatedKey,"DynamicsWebApi.disassociate","request.relatedId");return t.key=n,t.navigationProperty=`${e.relationshipName}(${a})/$ref`,this._makeRequest(t).then(()=>{})};this.associateSingleValued=e=>{i.parameterCheck(e,"DynamicsWebApi.associateSingleValued","request");let t=c.copyRequest(e);t.method="PUT",t.functionName="associateSingleValued";let n=i.keyParameterCheck(e.primaryKey,"DynamicsWebApi.associateSingleValued","request.primaryKey"),a=i.keyParameterCheck(e.relatedKey,"DynamicsWebApi.associateSingleValued","request.relatedKey");return i.stringParameterCheck(e.navigationProperty,"DynamicsWebApi.associateSingleValued","request.navigationProperty"),i.stringParameterCheck(e.relatedCollection,"DynamicsWebApi.associateSingleValued","request.relatedcollection"),t.navigationProperty+="/$ref",t.key=n,t.data={"@odata.id":`${e.relatedCollection}(${a})`},this._makeRequest(t).then(()=>{})};this.disassociateSingleValued=e=>{i.parameterCheck(e,"DynamicsWebApi.disassociateSingleValued","request");let t=c.copyRequest(e);t.method="DELETE",t.functionName="disassociateSingleValued";let n=i.keyParameterCheck(e.primaryKey,"DynamicsWebApi.disassociateSingleValued","request.primaryKey");return i.stringParameterCheck(e.navigationProperty,"DynamicsWebApi.disassociateSingleValued","request.navigationProperty"),t.navigationProperty+="/$ref",t.key=n,this._makeRequest(t).then(()=>{})};this.callFunction=e=>{i.parameterCheck(e,"DynamicsWebApi.callFunction","request");let t=c.isObject(e),n=t?"request.functionName":"name",a=t?c.copyObject(e):{functionName:e};return i.stringParameterCheck(a.functionName,"DynamicsWebApi.callFunction",n),a.method="GET",a._additionalUrl=a.functionName+c.buildFunctionParameters(a.parameters),a._isUnboundRequest=!a.collection,a.functionName="callFunction",this._makeRequest(a).then(function(r){return r.data})};this.callAction=e=>{i.parameterCheck(e,"DynamicsWebApi.callAction","request"),i.stringParameterCheck(e.actionName,"DynamicsWebApi.callAction","request.actionName");let t=c.copyRequest(e,["action"]);return t.method="POST",t.functionName="callAction",t._additionalUrl=e.actionName,t._isUnboundRequest=!t.collection,t.data=e.action,this._makeRequest(t).then(n=>n.data)};this.createEntity=e=>{i.parameterCheck(e,"DynamicsWebApi.createEntity","request"),i.parameterCheck(e.data,"DynamicsWebApi.createEntity","request.data");let t=c.copyRequest(e);return t.collection="EntityDefinitions",t.functionName="createEntity",this.create(t)};this.updateEntity=e=>{i.parameterCheck(e,"DynamicsWebApi.updateEntity","request"),i.parameterCheck(e.data,"DynamicsWebApi.updateEntity","request.data"),i.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateEntity","request.data.MetadataId");let t=c.copyRequest(e);return t.collection="EntityDefinitions",t.key=t.data.MetadataId,t.functionName="updateEntity",t.method="PUT",this.update(t)};this.retrieveEntity=e=>{i.parameterCheck(e,"DynamicsWebApi.retrieveEntity","request"),i.keyParameterCheck(e.key,"DynamicsWebApi.retrieveEntity","request.key");let t=c.copyRequest(e);return t.collection="EntityDefinitions",t.functionName="retrieveEntity",this.retrieve(t)};this.retrieveEntities=e=>{let t=e?c.copyRequest(e):{};return t.collection="EntityDefinitions",t.functionName="retrieveEntities",this.retrieveMultiple(t)};this.createAttribute=e=>{i.parameterCheck(e,"DynamicsWebApi.createAttribute","request"),i.parameterCheck(e.data,"DynamicsWebApi.createAttribute","request.data"),i.keyParameterCheck(e.entityKey,"DynamicsWebApi.createAttribute","request.entityKey");let t=c.copyRequest(e);return t.collection="EntityDefinitions",t.functionName="retrieveEntity",t.navigationProperty="Attributes",t.key=e.entityKey,this.create(t)};this.updateAttribute=e=>{i.parameterCheck(e,"DynamicsWebApi.updateAttribute","request"),i.parameterCheck(e.data,"DynamicsWebApi.updateAttribute","request.data"),i.keyParameterCheck(e.entityKey,"DynamicsWebApi.updateAttribute","request.entityKey"),i.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateAttribute","request.data.MetadataId"),e.castType&&i.stringParameterCheck(e.castType,"DynamicsWebApi.updateAttribute","request.castType");let t=c.copyRequest(e);return t.collection="EntityDefinitions",t.navigationProperty="Attributes",t.navigationPropertyKey=e.data.MetadataId,t.metadataAttributeType=e.castType,t.key=e.entityKey,t.functionName="updateAttribute",t.method="PUT",this.update(t)};this.retrieveAttributes=e=>{i.parameterCheck(e,"DynamicsWebApi.retrieveAttributes","request"),i.keyParameterCheck(e.entityKey,"DynamicsWebApi.retrieveAttributes","request.entityKey"),e.castType&&i.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveAttributes","request.castType");let t=c.copyRequest(e);return t.collection="EntityDefinitions",t.navigationProperty="Attributes",t.metadataAttributeType=e.castType,t.key=e.entityKey,t.functionName="retrieveAttributes",this.retrieveMultiple(t)};this.retrieveAttribute=e=>{i.parameterCheck(e,"DynamicsWebApi.retrieveAttributes","request"),i.keyParameterCheck(e.entityKey,"DynamicsWebApi.retrieveAttribute","request.entityKey"),i.keyParameterCheck(e.attributeKey,"DynamicsWebApi.retrieveAttribute","request.attributeKey"),e.castType&&i.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveAttribute","request.castType");let t=c.copyRequest(e);return t.collection="EntityDefinitions",t.navigationProperty="Attributes",t.navigationPropertyKey=e.attributeKey,t.metadataAttributeType=e.castType,t.key=e.entityKey,t.functionName="retrieveAttribute",this.retrieve(t)};this.createRelationship=e=>{i.parameterCheck(e,"DynamicsWebApi.createRelationship","request"),i.parameterCheck(e.data,"DynamicsWebApi.createRelationship","request.data");let t=c.copyRequest(e);return t.collection="RelationshipDefinitions",t.functionName="createRelationship",this.create(t)};this.updateRelationship=e=>{i.parameterCheck(e,"DynamicsWebApi.updateRelationship","request"),i.parameterCheck(e.data,"DynamicsWebApi.updateRelationship","request.data"),i.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateRelationship","request.data.MetadataId"),e.castType&&i.stringParameterCheck(e.castType,"DynamicsWebApi.updateRelationship","request.castType");let t=c.copyRequest(e);return t.collection="RelationshipDefinitions",t.key=e.data.MetadataId,t.navigationProperty=e.castType,t.functionName="updateRelationship",t.method="PUT",this.update(t)};this.deleteRelationship=e=>{i.parameterCheck(e,"DynamicsWebApi.deleteRelationship","request"),i.keyParameterCheck(e.key,"DynamicsWebApi.deleteRelationship","request.key");let t=c.copyRequest(e);return t.collection="RelationshipDefinitions",t.functionName="deleteRelationship",this.deleteRecord(t)};this.retrieveRelationships=e=>{let t=e?c.copyRequest(e):{};return t.collection="RelationshipDefinitions",t.functionName="retrieveRelationships",e&&e.castType&&(i.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveRelationships","request.castType"),t.navigationProperty=e.castType),this.retrieveMultiple(t)};this.retrieveRelationship=e=>{i.parameterCheck(e,"DynamicsWebApi.retrieveRelationship","request"),i.keyParameterCheck(e.key,"DynamicsWebApi.retrieveRelationship","request.key"),e.castType&&i.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveRelationship","request.castType");let t=c.copyRequest(e);return t.collection="RelationshipDefinitions",t.navigationProperty=e.castType,t.functionName="retrieveRelationship",this.retrieve(t)};this.createGlobalOptionSet=e=>{i.parameterCheck(e,"DynamicsWebApi.createGlobalOptionSet","request"),i.parameterCheck(e.data,"DynamicsWebApi.createGlobalOptionSet","request.data");let t=c.copyRequest(e);return t.collection="GlobalOptionSetDefinitions",t.functionName="createGlobalOptionSet",this.create(t)};this.updateGlobalOptionSet=e=>{i.parameterCheck(e,"DynamicsWebApi.updateGlobalOptionSet","request"),i.parameterCheck(e.data,"DynamicsWebApi.updateGlobalOptionSet","request.data"),i.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateGlobalOptionSet","request.data.MetadataId"),e.castType&&i.stringParameterCheck(e.castType,"DynamicsWebApi.updateGlobalOptionSet","request.castType");let t=c.copyRequest(e);return t.collection="GlobalOptionSetDefinitions",t.key=e.data.MetadataId,t.functionName="updateGlobalOptionSet",t.method="PUT",this.update(t)};this.deleteGlobalOptionSet=e=>{i.parameterCheck(e,"DynamicsWebApi.deleteGlobalOptionSet","request");let t=c.copyRequest(e);return t.collection="GlobalOptionSetDefinitions",t.functionName="deleteGlobalOptionSet",this.deleteRecord(t)};this.retrieveGlobalOptionSet=e=>{i.parameterCheck(e,"DynamicsWebApi.retrieveGlobalOptionSet","request"),e.castType&&i.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveGlobalOptionSet","request.castType");let t=c.copyRequest(e);return t.collection="GlobalOptionSetDefinitions",t.navigationProperty=e.castType,t.functionName="retrieveGlobalOptionSet",this.retrieve(t)};this.retrieveGlobalOptionSets=e=>{let t=e?c.copyRequest(e):{};return t.collection="GlobalOptionSetDefinitions",t.functionName="retrieveGlobalOptionSets",e!=null&&e.castType&&(i.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveGlobalOptionSets","request.castType"),t.navigationProperty=e.castType),this.retrieveMultiple(t)};this.retrieveCsdlMetadata=e=>{let t=e?c.copyRequest(e):{};return t.collection="$metadata",t.functionName="retrieveCsdlMetadata",e!=null&&e.addAnnotations&&(i.boolParameterCheck(e.addAnnotations,"DynamicsWebApi.retrieveCsdlMetadata","request.addAnnotations"),t.includeAnnotations="*"),this._makeRequest(t).then(n=>n.data)};this.search=e=>{i.parameterCheck(e,"DynamicsWebApi.search","request");let t=c.isObject(e),n=t?"request.query.search":"term",a=t?c.copyObject(e):{query:{search:e}};return i.parameterCheck(a.query,"DynamicsWebApi.search","request.query"),i.stringParameterCheck(a.query.search,"DynamicsWebApi.search",n),i.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.search",n,100),a.collection="query",a.functionName="search",a.method="POST",a.data=a.query,a.apiConfig=this._config.searchApi,delete a.query,this._makeRequest(a).then(r=>r.data)};this.suggest=e=>{i.parameterCheck(e,"DynamicsWebApi.suggest","request");let t=c.isObject(e),n=t?"request.query.search":"term",a=t?c.copyObject(e):{query:{search:e}};return i.parameterCheck(a.query,"DynamicsWebApi.suggest","request.query"),i.stringParameterCheck(a.query.search,"DynamicsWebApi.suggest",n),i.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.suggest",n,100),a.functionName=a.collection="suggest",a.method="POST",a.data=a.query,a.apiConfig=this._config.searchApi,delete a.query,this._makeRequest(a).then(r=>r.data)};this.autocomplete=e=>{i.parameterCheck(e,"DynamicsWebApi.autocomplete","request");let t=c.isObject(e),n=t?"request.query.search":"term",a=t?c.copyObject(e):{query:{search:e}};return t&&i.parameterCheck(a.query,"DynamicsWebApi.autocomplete","request.query"),i.stringParameterCheck(a.query.search,"DynamicsWebApi.autocomplete",n),i.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.autocomplete",n,100),a.functionName=a.collection="autocomplete",a.method="POST",a.data=a.query,a.apiConfig=this._config.searchApi,delete a.query,this._makeRequest(a).then(r=>r.data)};this.startBatch=()=>{this._isBatch=!0,this._batchRequestId=c.generateUUID()};this.executeBatch=e=>{i.throwBatchNotStarted(this._isBatch);let t=e?c.copyRequest(e):{};t.collection="$batch",t.method="POST",t.functionName="executeBatch",this._isBatch=!1;let n=this._makeRequest(t).then(function(a){return a.data});return this._batchRequestId=null,n};this.initializeInstance=e=>new E(e||this._config);this.Utility={getCollectionName:e=>N.getCollectionName(e)};T.merge(this._config,e)}};0&&(module.exports={DynamicsWebApi});
//# sourceMappingURL=dynamics-web-api.cjs.min.js.map
