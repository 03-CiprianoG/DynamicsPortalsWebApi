/*! dynamics-web-api v2.0.0-alpha.1 (c) 2023 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DynamicsWebApi",[],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(self,(()=>(()=>{"use strict";var e={94:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RequestClient=void 0;const a=r(811),i=r(497),n=r(897);class o{static addResponseParams(e,t){o._responseParseParams[e]?o._responseParseParams[e].push(t):o._responseParseParams[e]=[t]}static addRequestToBatchCollection(e,t){o._batchRequestCollection[e]?o._batchRequestCollection[e].push(t):o._batchRequestCollection[e]=[t]}static sendRequest(e,t,s,c){e.headers=e.headers||{},e.responseParameters=e.responseParameters||{},e.requestId=e.requestId||a.Utility.generateUUID(),o.addResponseParams(e.requestId,e.responseParameters);let l=null;const p=null!=e.responseParameters&&e.responseParameters.convertedToBatch;if("$batch"!==e.path||p)l=p?e.data:i.RequestUtility.processData(e.data,t),p||(e.headers=i.RequestUtility.setStandardHeaders(e.headers));else{const r=o._batchRequestCollection[e.requestId];r||c(n.ErrorHelper.batchIsEmpty());const a=i.RequestUtility.convertToBatch(r,t);l=a.body,e.headers=Object.assign(Object.assign({},a.headers),e.headers),delete o._batchRequestCollection[e.requestId]}var u;t.impersonate&&!e.headers.MSCRMCallerID&&(e.headers.MSCRMCallerID=t.impersonate),t.impersonateAAD&&!e.headers.CallerObjectId&&(e.headers.CallerObjectId=t.impersonateAAD),u=r(830).t.xhrRequest;var m=function(r){r&&(e.headers||(e.headers={}),e.headers.Authorization="Bearer "+(r.hasOwnProperty("accessToken")?r.accessToken:r));const a=e.apiConfig?e.apiConfig.url:t.dataApi.url;u({method:e.method,uri:a+e.path,data:l,additionalHeaders:e.headers,responseParams:o._responseParseParams,successCallback:s,errorCallback:c,isAsync:e.async,timeout:e.timeout||t.timeout,requestId:e.requestId})};t.onTokenRefresh&&(!e.headers||e.headers&&!e.headers.Authorization)?t.onTokenRefresh(m):m()}static _getCollectionNames(e,t,r,n){if(a.Utility.isNull(i.RequestUtility.entityNames)){const a=function(t){i.RequestUtility.entityNames={};for(var a=0;a<t.data.value.length;a++)i.RequestUtility.entityNames[t.data.value[a].LogicalName]=t.data.value[a].EntitySetName;r(i.RequestUtility.findCollectionName(e)||e)},s=function(e){n({message:"Unable to fetch EntityDefinitions. Error: "+e.message})},c=i.RequestUtility.compose({method:"GET",collection:"EntityDefinitions",select:["EntitySetName","LogicalName"],noCache:!0,functionName:"retrieveMultiple"},t);o.sendRequest(c,t,a,s)}else r(i.RequestUtility.findCollectionName(e)||e)}static _isEntityNameException(e){return["$metadata","EntityDefinitions","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions","query","suggest","autocomplete"].indexOf(e)>-1}static _checkCollectionName(e,t,r,a){if(e&&!o._isEntityNameException(e))if(e=e.toLowerCase(),t.useEntityNames)try{o._getCollectionNames(e,t,r,a)}catch(e){a({message:"Unable to fetch Collection Names. Error: "+e.message})}else r(e);else r(e)}static makeRequest(e,t,r,a){e.responseParameters=e.responseParameters||{},e.isBatch?(e=i.RequestUtility.compose(e,t),o.addResponseParams(e.requestId,e.responseParameters),o.addRequestToBatchCollection(e.requestId,e)):o._checkCollectionName(e.collection,t,(n=>{if(e.collection=n,(e=i.RequestUtility.compose(e,t)).responseParameters.convertedToBatch=!1,e.path.length>2e3){const r=i.RequestUtility.convertToBatch([e],t);e.method="POST",e.path="$batch",e.data=r.body,e.headers=r.headers,e.responseParameters.convertedToBatch=!0}o.sendRequest(e,t,r,a)}),a)}static getCollectionName(e){return i.RequestUtility.findCollectionName(e)}}o._batchRequestCollection={},o._responseParseParams={},t.RequestClient=o},526:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dateReviver=void 0,t.dateReviver=function(e,t){if("string"==typeof t){const e=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/.exec(t);if(e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],+e[4],+e[5],+e[6]))}return t}},373:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseResponse=void 0;const a=r(553),i=r(811),n=r(897),o=r(526);function s(e,t){let r=null;if(-1!==e.indexOf("@")){const i=e.split("@");switch(i[1]){case"odata.context":r="oDataContext";break;case"odata.count":r="oDataCount",t=null!=t?parseInt(t):0;break;case"odata.nextLink":r="oDataNextLink";break;case"odata.deltaLink":r="oDataDeltaLink";break;case a.DWA.Prefer.Annotations.FormattedValue:r=i[0]+"_Formatted";break;case a.DWA.Prefer.Annotations.AssociatedNavigationProperty:r=i[0]+"_NavigationProperty";break;case a.DWA.Prefer.Annotations.LookupLogicalName:r=i[0]+"_LogicalName"}}return[r,t]}function c(e,t){if(t){if(t.isRef&&null!=e["@odata.id"])return i.Utility.convertToReferenceObject(e);if(t.toCount)return s("@odata.count",e["@odata.count"])[1]||0}const r=Object.keys(e);for(let t=0;t<r.length;t++){const a=r[t];if(null!=e[a])if(e[a].constructor===Array)for(var n=0;n<e[a].length;n++)e[a][n]=c(e[a][n]);else"object"==typeof e[a]&&c(e[a]);let i=s(a,e[a]);if(i[0]&&(e[i[0]]=i[1]),-1!==a.indexOf("_x002e_")){const t=a.split("_x002e_");if(e.hasOwnProperty(t[0])){if("object"!=typeof e[t[0]]||"object"==typeof e[t[0]]&&!e[t[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!")}else e[t[0]]={_dwaType:"alias"};e[t[0]][t[1]]=e[a],i=s(t[1],e[a]),i[0]&&(e[t[0]][i[0]]=i[1])}}return t&&t.hasOwnProperty("pageNumber")&&null!=e["@"+a.DWA.Prefer.Annotations.FetchXmlPagingCookie]&&(e.PagingInfo=i.Utility.getFetchXmlPagingCookie(e["@"+a.DWA.Prefer.Annotations.FetchXmlPagingCookie],t.pageNumber)),e}const l=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/;function p(e){const t={position:0},r={};let a,i,n;do{n=t.position,i=u(e,t),a=l.exec(i),null!==a?r[a[1].toLowerCase()]=a[2]:t.position=n}while(i&&a);return r}function u(e,t){return function(e,t,r){const a=t.position||0;let i=e.length;if(r){if(i=e.indexOf(r,a),-1===i)return null;t.position=i+r.length}else t.position=i;return e.substring(a,i)}(e,t,"\r\n")}function m(e,t,r=0){const a=e.substr(0,e.indexOf("\r\n")),i=e.split(a);i.shift(),i.pop();let s=[];for(let e=0;e<i.length;e++){let a=i[e];if(a.indexOf("--changesetresponse_")>-1){a=a.trim();const e=a.substring(a.indexOf("\r\n")+1).trim();s=s.concat(m(e,t,r))}else{const e=/HTTP\/?\s*[\d.]*\s+(\d{3})\s+([\w\s]*)$/gm.exec(a),i=parseInt(e[1]),l=e[2].trim(),u=a.substring(a.indexOf("{"),a.lastIndexOf("}")+1);if(u){const m=c(JSON.parse(u,o.dateReviver),t[r]);if(i>=400){const t=p(a.substring(a.indexOf(e[0])+e[0].length+1,a.indexOf("{")));s.push(n.ErrorHelper.handleHttpError(m,{status:i,statusText:l,statusMessage:l,headers:t}))}else s.push(m)}else if(/Content-Type: text\/plain/i.test(a)){const e=/\w+$/gi.exec(a.trim()),t=e&&e.length?e[0]:void 0;s.push(isNaN(Number(t))?t:Number(t))}else if(t.length&&t[r]&&t[r].hasOwnProperty("valueIfEmpty"))s.push(t[r].valueIfEmpty);else{const e=/OData-EntityId.+/i.exec(a);if(e&&e.length){const t=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(e[0]);s.push(t?t[1]:void 0)}else s.push(void 0)}}r++}return s}function h(e,t,r){let a=e;var i;r.hasOwnProperty("parse")&&(a=JSON.parse(a).value,i=a,a=window.atob(i));var n={value:a};return t["x-ms-file-name"]&&(n.fileName=t["x-ms-file-name"]),t["x-ms-file-size"]&&(n.fileSize=parseInt(t["x-ms-file-size"])),d(t,"Location")&&(n.location=y(t,"Location")),n}function d(e,t){return e.hasOwnProperty(t)||e.hasOwnProperty(t.toLowerCase())}function y(e,t){return e[t]?e[t]:e[t.toLowerCase()]}t.parseResponse=function(e,t,r){let a;if(e.length)if(e.indexOf("--batchresponse_")>-1){const t=m(e,r);a=1===r.length&&r[0].convertedToBatch?t[0]:t}else if(d(t,"Content-Disposition"))a=h(e,t,r[0]);else{a=y(t,"Content-Type").startsWith("application/json")?c(JSON.parse(e,o.dateReviver),r[0]):isNaN(Number(e))?e:Number(e)}else if(r.length&&r[0].hasOwnProperty("valueIfEmpty"))a=r[0].valueIfEmpty;else if(d(t,"OData-EntityId")){const e=y(t,"OData-EntityId"),r=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(e);r&&(a=r[1])}else d(t,"Location")&&(a={location:y(t,"Location")},t["x-ms-chunk-size"]&&(a.chunkSize=parseInt(t["x-ms-chunk-size"])));return a}},394:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseResponseHeaders=void 0,t.parseResponseHeaders=function(e){const t={};if(!e)return t;const r=e.split("\r\n");for(let e=0,a=r.length;e<a;e++){const a=r[e],i=a.indexOf(": ");i>0&&(t[a.substring(0,i)]=a.substring(i+2))}return t}},830:(e,t,r)=>{t.t=void 0;const a=r(897),i=r(373),n=r(394);class o{static xhrRequest(e){const t=e.data,r=e.additionalHeaders,s=e.responseParams,c=e.successCallback,l=e.errorCallback,p=new XMLHttpRequest;p.open(e.method,e.uri,e.isAsync||!1);for(let e in r)p.setRequestHeader(e,r[e]);p.onreadystatechange=function(){if(4===p.readyState)switch(p.status){case 200:case 201:case 204:case 206:case 304:{const t=(0,n.parseResponseHeaders)(p.getAllResponseHeaders()),r={data:(0,i.parseResponse)(p.responseText,t,s[e.requestId]),headers:t,status:p.status};delete s[e.requestId],c(r);break}default:let t,r;try{r=(0,n.parseResponseHeaders)(p.getAllResponseHeaders());const a=(0,i.parseResponse)(p.responseText,(0,n.parseResponseHeaders)(p.getAllResponseHeaders()),s[e.requestId]);if(Array.isArray(a)){delete s[e.requestId],l(a);break}t=a.error}catch(e){t=p.response.length>0?{message:p.response}:{message:"Unexpected Error"}}const o={status:p.status,statusText:p.statusText,headers:r};delete s[e.requestId],l(a.ErrorHelper.handleHttpError(t,o))}},e.timeout&&(p.timeout=e.timeout),p.onerror=function(){const t=(0,n.parseResponseHeaders)(p.getAllResponseHeaders());l(a.ErrorHelper.handleHttpError({status:p.status,statusText:p.statusText,message:p.responseText||"Network Error",headers:t})),delete s[e.requestId]},p.ontimeout=function(){const t=(0,n.parseResponseHeaders)(p.getAllResponseHeaders());l(a.ErrorHelper.handleHttpError({status:p.status,statusText:p.statusText,message:p.responseText||"Request Timed Out",headers:t})),delete s[e.requestId]},t?p.send(t):p.send(),o.afterSendEvent&&o.afterSendEvent()}}t.t=o},553:function(e,t){var r,a,i=this&&this.__setFunctionName||function(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})};Object.defineProperty(t,"__esModule",{value:!0}),t.DWA=void 0;class n{}t.DWA=n,n.Prefer=(i(r=class{static get(e){return`${n.Prefer.IncludeAnnotations}="${e}"`}},"Prefer"),r.ReturnRepresentation="return=representation",r.Annotations=(i(a=class{},"Annotations"),a.AssociatedNavigationProperty="Microsoft.Dynamics.CRM.associatednavigationproperty",a.LookupLogicalName="Microsoft.Dynamics.CRM.lookuplogicalname",a.All="*",a.FormattedValue="OData.Community.Display.V1.FormattedValue",a.FetchXmlPagingCookie="Microsoft.Dynamics.CRM.fetchxmlpagingcookie",a),r.IncludeAnnotations="odata.include-annotations",r)},897:(e,t)=>{function r(e,t,r){throw new Error(r?`${e} requires a ${t} parameter to be of type ${r}.`:`${e} requires a ${t} parameter.`)}Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorHelper=void 0;class a{static handleErrorResponse(e){throw new Error(`Error: ${e.status}: ${e.message}`)}static parameterCheck(e,t,a,i){null!=e&&""!==e||r(t,a,i)}static stringParameterCheck(e,t,a){"string"!=typeof e&&r(t,a,"String")}static maxLengthStringParameterCheck(e,t,r,a){if(e&&e.length>a)throw new Error(`${r} has a ${a} character limit.`)}static arrayParameterCheck(e,t,a){e.constructor!==Array&&r(t,a,"Array")}static stringOrArrayParameterCheck(e,t,a){e.constructor!==Array&&"string"!=typeof e&&r(t,a,"String or Array")}static numberParameterCheck(e,t,a){if("number"!=typeof e){if("string"==typeof e&&e&&!isNaN(parseInt(e)))return;r(t,a,"Number")}}static batchIsEmpty(){return[new Error("Payload of the batch operation is empty. Please make that you have other operations in between startBatch() and executeBatch() to successfuly build a batch payload.")]}static handleHttpError(e,t){const r=new Error;return Object.keys(e).forEach((t=>{r[t]=e[t]})),t&&Object.keys(t).forEach((e=>{r[e]=t[e]})),r}static boolParameterCheck(e,t,a){"boolean"!=typeof e&&r(t,a,"Boolean")}static guidParameterCheck(e,t,a){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){r(t,a,"GUID String")}}static keyParameterCheck(e,t,i){try{a.stringParameterCheck(e,t,i);const r=/^{?([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})}?$/i.exec(e);if(r)return r[1];const n=e.split(",");if(n.length)for(let e=0;e<n.length;e++)n[e]=n[e].trim().replace(/"/g,"'"),/^[\w\d\_]+\=(.+)$/i.exec(n[e])[0];return n.join(",")}catch(e){r(t,i,"String representing GUID or Alternate Key")}}static callbackParameterCheck(e,t,a){"function"!=typeof e&&r(t,a,"Function")}static throwBatchIncompatible(e,t){if(t)throw t=!1,new Error(e+" cannot be used in a BATCH request.")}static throwBatchNotStarted(e){if(!e)throw new Error("Batch operation has not been started. Please call a DynamicsWebApi.startBatch() function prior to calling DynamicsWebApi.executeBatch() to perform a batch request correctly.")}}t.ErrorHelper=a},177:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationUtility=void 0;const a=r(811),i=r(897),n=(e,t,r)=>{const n=r[t];(null==e?void 0:e.version)&&(i.ErrorHelper.stringParameterCheck(e.version,"DynamicsWebApi.setConfig",`config.${t}.version`),n.version=e.version),(null==e?void 0:e.path)&&(i.ErrorHelper.stringParameterCheck(e.path,"DynamicsWebApi.setConfig",`config.${t}.path`),n.path=e.path),n.url=((e,t)=>(e||(e=a.Utility.getClientUrl()),`${e}/api/${t.path}/v${t.version}/`))(r.serverUrl,n)};class o{static merge(e,t){(null==t?void 0:t.serverUrl)&&(i.ErrorHelper.stringParameterCheck(t.serverUrl,"DynamicsWebApi.setConfig","config.serverUrl"),e.serverUrl=t.serverUrl),n(null==t?void 0:t.dataApi,"dataApi",e),n(null==t?void 0:t.searchApi,"searchApi",e),(null==t?void 0:t.impersonate)&&(e.impersonate=i.ErrorHelper.guidParameterCheck(t.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),(null==t?void 0:t.impersonateAAD)&&(e.impersonateAAD=i.ErrorHelper.guidParameterCheck(t.impersonateAAD,"DynamicsWebApi.setConfig","config.impersonateAAD")),(null==t?void 0:t.onTokenRefresh)&&(i.ErrorHelper.callbackParameterCheck(t.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),e.onTokenRefresh=t.onTokenRefresh),(null==t?void 0:t.includeAnnotations)&&(i.ErrorHelper.stringParameterCheck(t.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),e.includeAnnotations=t.includeAnnotations),(null==t?void 0:t.timeout)&&(i.ErrorHelper.numberParameterCheck(t.timeout,"DynamicsWebApi.setConfig","config.timeout"),e.timeout=t.timeout),(null==t?void 0:t.maxPageSize)&&(i.ErrorHelper.numberParameterCheck(t.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),e.maxPageSize=t.maxPageSize),(null==t?void 0:t.returnRepresentation)&&(i.ErrorHelper.boolParameterCheck(t.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),e.returnRepresentation=t.returnRepresentation),(null==t?void 0:t.useEntityNames)&&(i.ErrorHelper.boolParameterCheck(t.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),e.useEntityNames=t.useEntityNames)}static default(){return{serverUrl:null,impersonate:null,impersonateAAD:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null,proxy:null,dataApi:{path:"data",version:"9.2",url:""},searchApi:{path:"search",version:"1.0",url:""}}}}o.mergeApiConfigs=n,t.ConfigurationUtility=o},497:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RequestUtility=void 0;const a=r(811),i=r(897);class n{static compose(e,t){if(e.path=e.path||"",e.functionName=e.functionName||"",e.url)i.ErrorHelper.stringParameterCheck(e.url,`DynamicsWebApi.${e.functionName}`,"request.url"),e.path=e.url.replace(t.dataApi.url,""),e.path=n.composeUrl(e,t,e.path);else if(e._isUnboundRequest||e.collection||i.ErrorHelper.parameterCheck(e.collection,`DynamicsWebApi.${e.functionName}`,"request.collection"),null!=e.collection&&(i.ErrorHelper.stringParameterCheck(e.collection,`DynamicsWebApi.${e.functionName}`,"request.collection"),e.path=e.collection,e.contentId&&(i.ErrorHelper.stringParameterCheck(e.contentId,`DynamicsWebApi.${e.functionName}`,"request.contentId"),e.contentId.startsWith("$")&&(e.path=`${e.contentId}/${e.path}`)),e.key?e.key=i.ErrorHelper.keyParameterCheck(e.key,`DynamicsWebApi.${e.functionName}`,"request.key"):e.id&&(e.key=i.ErrorHelper.guidParameterCheck(e.id,`DynamicsWebApi.${e.functionName}`,"request.id")),e.key&&(e.path+=`(${e.key})`)),e._additionalUrl&&(e.path&&(e.path+="/"),e.path+=e._additionalUrl),e.path=n.composeUrl(e,t,e.path),e.fetchXml){i.ErrorHelper.stringParameterCheck(e.fetchXml,`DynamicsWebApi.${e.functionName}`,"request.fetchXml");let t=-1===e.path.indexOf("?")?"?":"&";e.path+=`${t}fetchXml=${encodeURIComponent(e.fetchXml)}`}return e.hasOwnProperty("async")&&null!=e.async?i.ErrorHelper.boolParameterCheck(e.async,`DynamicsWebApi.${e.functionName}`,"request.async"):e.async=!0,e.headers=n.composeHeaders(e,t),e}static composeUrl(e,t,r="",a="&"){var o,s,c;const l=[];if(e){if(e.navigationProperty){if(i.ErrorHelper.stringParameterCheck(e.navigationProperty,`DynamicsWebApi.${e.functionName}`,"request.navigationProperty"),r+="/"+e.navigationProperty,e.navigationPropertyKey){r+="("+i.ErrorHelper.keyParameterCheck(e.navigationPropertyKey,`DynamicsWebApi.${e.functionName}`,"request.navigationPropertyKey")+")"}"Attributes"===e.navigationProperty&&e.metadataAttributeType&&(i.ErrorHelper.stringParameterCheck(e.metadataAttributeType,`DynamicsWebApi.${e.functionName}`,"request.metadataAttributeType"),r+="/"+e.metadataAttributeType)}if((null===(o=e.select)||void 0===o?void 0:o.length)&&(i.ErrorHelper.arrayParameterCheck(e.select,`DynamicsWebApi.${e.functionName}`,"request.select"),"retrieve"==e.functionName&&1==e.select.length&&e.select[0].endsWith("/$ref")?r+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==e.functionName&&(null==e.navigationProperty?r+=e.select.shift():e.select.shift()),e.select.length&&l.push("$select="+e.select.join(",")))),e.filter){i.ErrorHelper.stringParameterCheck(e.filter,`DynamicsWebApi.${e.functionName}`,"request.filter");const t=/[^"']{([\w\d]{8}[-]?(?:[\w\d]{4}[-]?){3}[\w\d]{12})}(?:[^"']|$)/g;let r=e.filter,a=null;for(;null!==(a=t.exec(r));){a.index===t.lastIndex&&t.lastIndex++;let e=a[0].endsWith(")")?")":" ";r=r.replace(a[0]," "+a[1]+e)}l.push("$filter="+encodeURIComponent(r))}if(e.fieldName&&(i.ErrorHelper.stringParameterCheck(e.fieldName,`DynamicsWebApi.${e.functionName}`,"request.fieldName"),r+="/"+e.fieldName),e.savedQuery&&l.push("savedQuery="+i.ErrorHelper.guidParameterCheck(e.savedQuery,`DynamicsWebApi.${e.functionName}`,"request.savedQuery")),e.userQuery&&l.push("userQuery="+i.ErrorHelper.guidParameterCheck(e.userQuery,`DynamicsWebApi.${e.functionName}`,"request.userQuery")),e.apply&&(i.ErrorHelper.stringParameterCheck(e.apply,`DynamicsWebApi.${e.functionName}`,"request.apply"),l.push("$apply="+e.apply)),e.count&&(i.ErrorHelper.boolParameterCheck(e.count,`DynamicsWebApi.${e.functionName}`,"request.count"),l.push("$count="+e.count)),e.top&&e.top>0&&(i.ErrorHelper.numberParameterCheck(e.top,`DynamicsWebApi.${e.functionName}`,"request.top"),l.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(i.ErrorHelper.arrayParameterCheck(e.orderBy,`DynamicsWebApi.${e.functionName}`,"request.orderBy"),l.push("$orderby="+e.orderBy.join(","))),e.partitionId&&(i.ErrorHelper.stringParameterCheck(e.partitionId,`DynamicsWebApi.${e.functionName}`,"request.partitionId"),l.push("partitionid='"+e.partitionId+"'")),e.downloadSize&&(i.ErrorHelper.stringParameterCheck(e.downloadSize,`DynamicsWebApi.${e.functionName}`,"request.downloadSize"),l.push("size="+e.downloadSize)),(null===(s=e.queryParams)||void 0===s?void 0:s.length)&&(i.ErrorHelper.arrayParameterCheck(e.queryParams,`DynamicsWebApi.${e.functionName}`,"request.queryParams"),l.push(e.queryParams.join("&"))),e.fileName&&(i.ErrorHelper.stringParameterCheck(e.fileName,`DynamicsWebApi.${e.functionName}`,"request.fileName"),l.push("x-ms-file-name="+e.fileName)),e.entity&&i.ErrorHelper.parameterCheck(e.entity,`DynamicsWebApi.${e.functionName}`,"request.entity"),e.data&&i.ErrorHelper.parameterCheck(e.data,`DynamicsWebApi.${e.functionName}`,"request.data"),e.isBatch&&i.ErrorHelper.boolParameterCheck(e.isBatch,`DynamicsWebApi.${e.functionName}`,"request.isBatch"),e.timeout&&i.ErrorHelper.numberParameterCheck(e.timeout,`DynamicsWebApi.${e.functionName}`,"request.timeout"),null===(c=e.expand)||void 0===c?void 0:c.length)if(i.ErrorHelper.stringOrArrayParameterCheck(e.expand,`DynamicsWebApi.${e.functionName}`,"request.expand"),"string"==typeof e.expand)l.push("$expand="+e.expand);else{const r=[];for(let a=0;a<e.expand.length;a++)if(e.expand[a].property){const i=e.expand[a];i.functionName=`${e.functionName} $expand`;let o=n.composeUrl(i,t,"",";");o&&(o=`(${o.substr(1)})`),r.push(e.expand[a].property+o)}r.length&&l.push("$expand="+r.join(","))}}return l.length?r+"?"+l.join(a):r}static composeHeaders(e,t){const r={},a=n.composePreferHeader(e,t);if(a.length&&(r.Prefer=a),"$metadata"===e.collection&&(r.Accept="application/xml"),e.transferMode&&(r["x-ms-transfer-mode"]=e.transferMode),null!=e.ifmatch&&null!=e.ifnonematch)throw new Error(`DynamicsWebApi.${e.functionName}. Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.`);return e.ifmatch&&(i.ErrorHelper.stringParameterCheck(e.ifmatch,`DynamicsWebApi.${e.functionName}`,"request.ifmatch"),r["If-Match"]=e.ifmatch),e.ifnonematch&&(i.ErrorHelper.stringParameterCheck(e.ifnonematch,`DynamicsWebApi.${e.functionName}`,"request.ifnonematch"),r["If-None-Match"]=e.ifnonematch),e.impersonate&&(i.ErrorHelper.stringParameterCheck(e.impersonate,`DynamicsWebApi.${e.functionName}`,"request.impersonate"),r.MSCRMCallerID=i.ErrorHelper.guidParameterCheck(e.impersonate,`DynamicsWebApi.${e.functionName}`,"request.impersonate")),e.impersonateAAD&&(i.ErrorHelper.stringParameterCheck(e.impersonateAAD,`DynamicsWebApi.${e.functionName}`,"request.impersonateAAD"),r.CallerObjectId=i.ErrorHelper.guidParameterCheck(e.impersonateAAD,`DynamicsWebApi.${e.functionName}`,"request.impersonateAAD")),e.token&&(i.ErrorHelper.stringParameterCheck(e.token,`DynamicsWebApi.${e.functionName}`,"request.token"),r.Authorization="Bearer "+e.token),e.duplicateDetection&&(i.ErrorHelper.boolParameterCheck(e.duplicateDetection,`DynamicsWebApi.${e.functionName}`,"request.duplicateDetection"),r["MSCRM.SuppressDuplicateDetection"]="false"),e.bypassCustomPluginExecution&&(i.ErrorHelper.boolParameterCheck(e.bypassCustomPluginExecution,`DynamicsWebApi.${e.functionName}`,"request.bypassCustomPluginExecution"),r["MSCRM.BypassCustomPluginExecution"]="true"),e.noCache&&(i.ErrorHelper.boolParameterCheck(e.noCache,`DynamicsWebApi.${e.functionName}`,"request.noCache"),r["Cache-Control"]="no-cache"),e.mergeLabels&&(i.ErrorHelper.boolParameterCheck(e.mergeLabels,`DynamicsWebApi.${e.functionName}`,"request.mergeLabels"),r["MSCRM.MergeLabels"]="true"),e.contentId&&(i.ErrorHelper.stringParameterCheck(e.contentId,`DynamicsWebApi.${e.functionName}`,"request.contentId"),e.contentId.startsWith("$")||(r["Content-ID"]=e.contentId)),e.contentRange&&(i.ErrorHelper.stringParameterCheck(e.contentRange,`DynamicsWebApi.${e.functionName}`,"request.contentRange"),r["Content-Range"]=e.contentRange),e.range&&(i.ErrorHelper.stringParameterCheck(e.range,`DynamicsWebApi.${e.functionName}`,"request.range"),r.Range=e.range),r}static composePreferHeader(e,t){let r=e.returnRepresentation,a=e.includeAnnotations,n=e.maxPageSize,o=e.trackChanges,s=[];if(e.prefer&&e.prefer.length){i.ErrorHelper.stringOrArrayParameterCheck(e.prefer,`DynamicsWebApi.${e.functionName}`,"request.prefer"),"string"==typeof e.prefer&&(s=e.prefer.split(","));for(let e in s){let t=s[e].trim();"return=representation"===t?r=!0:t.indexOf("odata.include-annotations=")>-1?a=t.replace("odata.include-annotations=","").replace(/"/g,""):t.startsWith("odata.maxpagesize=")?n=Number(t.replace("odata.maxpagesize=","").replace(/"/g,""))||0:t.indexOf("odata.track-changes")>-1&&(o=!0)}}return s=[],t&&(null==r&&(r=t.returnRepresentation),a=a||t.includeAnnotations,n=n||t.maxPageSize),r&&(i.ErrorHelper.boolParameterCheck(r,`DynamicsWebApi.${e.functionName}`,"request.returnRepresentation"),s.push("return=representation")),a&&(i.ErrorHelper.stringParameterCheck(a,`DynamicsWebApi.${e.functionName}`,"request.includeAnnotations"),s.push(`odata.include-annotations="${a}"`)),n&&n>0&&(i.ErrorHelper.numberParameterCheck(n,`DynamicsWebApi.${e.functionName}`,"request.maxPageSize"),s.push("odata.maxpagesize="+n)),o&&(i.ErrorHelper.boolParameterCheck(o,`DynamicsWebApi.${e.functionName}`,"request.trackChanges"),s.push("odata.track-changes")),s.join(",")}static convertToBatch(e,t){const r=`dwa_batch_${a.Utility.generateUUID()}`,i=[];let o=null,s=1e5;e.forEach((e=>{var c;e.functionName="executeBatch";const l="GET"===e.method;if(l&&o&&(i.push(`\n--${o}--`),o=null,s=1e5),o||(i.push(`\n--${r}`),l||(o=`changeset_${a.Utility.generateUUID()}`,i.push("Content-Type: multipart/mixed;boundary="+o))),l||i.push(`\n--${o}`),i.push("Content-Type: application/http"),i.push("Content-Transfer-Encoding: binary"),!l){const t=e.headers.hasOwnProperty("Content-ID")?e.headers["Content-ID"]:++s;i.push(`Content-ID: ${t}`)}(null===(c=e.path)||void 0===c?void 0:c.startsWith("$"))?i.push(`\n${e.method} ${e.path} HTTP/1.1`):i.push(`\n${e.method} ${t.dataApi.url}${e.path} HTTP/1.1`),l?i.push("Accept: application/json"):i.push("Content-Type: application/json");for(let t in e.headers)"Authorization"!==t&&"Content-ID"!==t&&i.push(`${t}: ${e.headers[t]}`);const p=e.data||e.entity;!l&&p&&i.push(`\n${n.processData(p,t)}`)})),o&&i.push(`\n--${o}--`),i.push(`\n--${r}--`);const c=n.setStandardHeaders();return c["Content-Type"]=`multipart/mixed;boundary=${r}`,{headers:c,body:i.join("\n")}}static findCollectionName(e){let t=null;if(!a.Utility.isNull(n.entityNames)&&(t=n.entityNames[e],a.Utility.isNull(t)))for(let t in n.entityNames)if(n.entityNames[t]===e)return e;return t}static processData(e,t){let r;if(e){if(e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array)return e;r=JSON.stringify(e,((e,r)=>{if(e.endsWith("@odata.bind")||e.endsWith("@odata.id")){if("string"==typeof r&&!r.startsWith("$")){if(/\(\{[\w\d-]+\}\)/g.test(r)&&(r=r.replace(/(.+)\(\{([\w\d-]+)\}\)/g,"$1($2)")),t.useEntityNames){const e=/([\w_]+)(\([\d\w-]+\))$/,t=e.exec(r);if(t&&t.length>2){const i=n.findCollectionName(t[1]);a.Utility.isNull(i)||(r=r.replace(e,i+"$2"))}}r.startsWith(t.dataApi.url)||(e.endsWith("@odata.bind")?r.startsWith("/")||(r="/"+r):r=t.dataApi.url+r.replace(/^\//,""))}}else(e.startsWith("oData")||e.endsWith("_Formatted")||e.endsWith("_NavigationProperty")||e.endsWith("_LogicalName"))&&(r=void 0);return r})),r=r.replace(/[\u007F-\uFFFF]/g,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)}))}return r}static setStandardHeaders(e={}){return e.Accept||(e.Accept="application/json"),e["OData-MaxVersion"]="4.0",e["OData-Version"]="4.0",e["Content-Type"]=e["Content-Range"]?"application/octet-stream":"application/json; charset=utf-8",e}}n.entityNames=null,t.RequestUtility=n},811:(e,t,r)=>{function a(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function i(){return window.crypto.getRandomValues(new Uint8Array(1))}Object.defineProperty(t,"__esModule",{value:!0}),t.Utility=void 0;class n{static buildFunctionParameters(e){if(e){const r=Object.keys(e);let a="",i="";for(var t=1;t<=r.length;t++){const n=r[t-1];let o=e[n];null!==o&&("string"!=typeof o||o.startsWith("Microsoft.Dynamics.CRM")?"object"==typeof o&&(o=JSON.stringify(o)):o="'"+o+"'",t>1&&(a+=",",i+="&"),a+=n+"=@p"+t,i+="@p"+t+"="+o)}return"("+a+")?"+i}return"()"}static getFetchXmlPagingCookie(e="",t=1){e=decodeURIComponent(decodeURIComponent(e));const r=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=r){let e=parseInt(r[2]);return{cookie:r[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:e,nextPage:e+1}}return{cookie:"",page:t,nextPage:t+1}}static convertToReferenceObject(e){const t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}static isNull(e){return void 0===e||null==e}static generateUUID(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^i()[0]&15>>e/4).toString(16)))}static getXrmContext(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm){if(!n.isNull(Xrm.Utility)&&!n.isNull(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!n.isNull(Xrm.Page)&&!n.isNull(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}static getXrmUtility(){return"undefined"!=typeof Xrm?Xrm.Utility:null}static getClientUrl(){let e=n.getXrmContext().getClientUrl();return e.match(/\/$/)&&(e=e.substring(0,e.length-1)),e}static isObject(e){return"object"===typeof e&&!!e}static copyObject(e,t=[]){let r={};for(let a in e)e.hasOwnProperty(a)&&!t.includes(a)&&(n.isObject(e[a])&&"[object Date]"!==Object.prototype.toString.call(e[a])?Array.isArray(e[a])?r[a]=e[a].slice():r[a]=n.copyObject(e[a]):r[a]=e[a]);return r}static setFileChunk(e,t,r,a){const i=(a=a||0)+r>t.length?t.length%r:r;let n;n=new Uint8Array(i);for(let e=0;e<i;e++)n[e]=t[a+e];e.data=n,e.contentRange="bytes "+a+"-"+(a+i-1)+"/"+t.length}static convertToFileBuffer(e){const t=new Uint8Array(e.length);for(var r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}}n.isNodeEnv=a,n.downloadChunkSize=4194304,t.Utility=n}},t={};function r(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var a={};return(()=>{var e=a;Object.defineProperty(e,"__esModule",{value:!0}),e.DynamicsWebApi=void 0;const t=r(177),i=r(811),n=r(897),o=r(94);class s{constructor(e){this._config=t.ConfigurationUtility.default(),this._isBatch=!1,this._batchRequestId=null,this.setConfig=e=>t.ConfigurationUtility.merge(this._config,e),this._makeRequest=e=>(e.isBatch=this._isBatch,e.requestId=this._batchRequestId,new Promise(((t,r)=>{o.RequestClient.makeRequest(e,this._config,t,r)}))),this.create=e=>{let t;return n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.create","request"),e.functionName?t=e:(t=i.Utility.copyObject(e),t.functionName="create"),t.method="POST",this._makeRequest(t).then((function(e){return e.data}))},this.retrieve=e=>{var t;let r;return n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.retrieve","request"),e.functionName?r=e:(r=i.Utility.copyObject(e),r.functionName="retrieve"),r.method="GET",r.responseParameters={isRef:1===(null===(t=r.select)||void 0===t?void 0:t.length)&&r.select[0].endsWith("/$ref")},this._makeRequest(r).then((function(e){return e.data}))},this.update=e=>{let t;n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.update","request"),e.functionName?t=e:(t=i.Utility.copyObject(e),t.functionName="update"),t.method||(t.method=/EntityDefinitions|RelationshipDefinitions|GlobalOptionSetDefinitions/.test(t.collection||"")?"PUT":"PATCH"),t.responseParameters={valueIfEmpty:!0},null==t.ifmatch&&(t.ifmatch="*");var r=t.ifmatch;return this._makeRequest(t).then((function(e){return e.data})).catch((function(e){if(r&&412===e.status)return!1;throw e}))},this.updateSingleProperty=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.updateSingleProperty","request"),n.ErrorHelper.parameterCheck(e.fieldValuePair,"DynamicsWebApi.updateSingleProperty","request.fieldValuePair");var t=Object.keys(e.fieldValuePair)[0],r=e.fieldValuePair[t];const a=i.Utility.copyObject(e);return a.navigationProperty=t,a.data={value:r},a.functionName="updateSingleProperty",a.method="PUT",delete a.fieldValuePair,this._makeRequest(a).then((function(e){return e.data}))},this.deleteRecord=e=>{let t;n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.deleteRecord","request"),e.functionName?t=e:(t=i.Utility.copyObject(e),t.functionName="deleteRecord"),t.method="DELETE",t.responseParameters={valueIfEmpty:!0};const r=t.ifmatch;return this._makeRequest(t).then((function(e){return e.data})).catch((function(e){if(r&&412===e.status)return!1;throw e}))},this.upsert=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.upsert","request");const t=i.Utility.copyObject(e);t.method="PATCH",t.functionName="upsert";const r=t.ifnonematch,a=t.ifmatch;return this._makeRequest(t).then((function(e){return e.data})).catch((function(e){if(!(r&&412===e.status||a&&404===e.status))throw e}))},this._uploadFileChunk=(e,t,r,a=0)=>(i.Utility.setFileChunk(e,t,r,a),this._makeRequest(e).then((()=>{if((a+=r)<=t.length)return this._uploadFileChunk(e,t,r,a)}))),this.uploadFile=e=>{n.ErrorHelper.throwBatchIncompatible("DynamicsWebApi.uploadFile",this._isBatch),n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.uploadFile","request");const t=i.Utility.copyObject(e,["data"]);return t.method="PATCH",t.functionName="uploadFile",t.transferMode="chunked",this._makeRequest(t).then((r=>(t.url=r.data.location,delete t.transferMode,delete t.fieldName,delete t.fileName,this._uploadFileChunk(t,e.data,r.data.chunkSize))))},this._downloadFileChunk=(e,t=0,r="")=>(e.range="bytes="+t+"-"+(t+i.Utility.downloadChunkSize-1),e.downloadSize="full",this._makeRequest(e).then((a=>(e.url=a.data.location,r+=a.data.value,(t+=i.Utility.downloadChunkSize)<=a.data.fileSize?this._downloadFileChunk(e,t,r):{fileName:a.data.fileName,fileSize:a.data.fileSize,data:i.Utility.convertToFileBuffer(r)})))),this.downloadFile=e=>{n.ErrorHelper.throwBatchIncompatible("DynamicsWebApi.downloadFile",this._isBatch),n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.downloadFile","request");const t=i.Utility.copyObject(e);return t.method="GET",t.functionName="downloadFile",t.responseParameters={parse:!0},this._downloadFileChunk(t)},this.retrieveMultiple=(e,t)=>{let r;return n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.retrieveMultiple","request"),e.functionName?r=e:(r=i.Utility.copyObject(e),r.functionName="retrieveMultiple"),r.method="GET",t&&(n.ErrorHelper.stringParameterCheck(t,"DynamicsWebApi.retrieveMultiple","nextPageLink"),r.url=t),this._makeRequest(r).then((function(e){return e.data}))},this._retrieveAllRequest=(e,t,r=[])=>this.retrieveMultiple(e,t).then((t=>{r=r.concat(t.value);const a=t.oDataNextLink;if(a)return this._retrieveAllRequest(e,a,r);const i={value:r};return t.oDataDeltaLink&&(i["@odata.deltaLink"]=t.oDataDeltaLink,i.oDataDeltaLink=t.oDataDeltaLink),i})),this.retrieveAll=e=>(n.ErrorHelper.throwBatchIncompatible("DynamicsWebApi.retrieveAll",this._isBatch),this._retrieveAllRequest(e)),this.count=e=>{var t;n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.count","request");const r=i.Utility.copyObject(e);return r.method="GET",r.functionName="count",(null===(t=r.filter)||void 0===t?void 0:t.length)?r.count=!0:r.navigationProperty="$count",r.responseParameters={toCount:r.count},this._makeRequest(r).then((function(e){return e.data}))},this.countAll=e=>(n.ErrorHelper.throwBatchIncompatible("DynamicsWebApi.countAll",this._isBatch),n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.countAll","request"),this._retrieveAllRequest(e).then((function(e){return e&&e.value?e.value.length:0}))),this.fetch=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.fetch","request");const t=i.Utility.copyObject(e);if(t.method="GET",t.functionName="fetch",n.ErrorHelper.stringParameterCheck(t.fetchXml,"DynamicsWebApi.fetch","request.fetchXml"),t.fetchXml&&!/^<fetch.+top=/.test(t.fetchXml)){let e="";/^<fetch.+page=/.test(t.fetchXml)||(t.pageNumber=t.pageNumber||1,n.ErrorHelper.numberParameterCheck(t.pageNumber,"DynamicsWebApi.fetch","request.pageNumber"),e=`$1 page="${t.pageNumber}"`),null!=t.pagingCookie&&(n.ErrorHelper.stringParameterCheck(t.pagingCookie,"DynamicsWebApi.fetch","request.pagingCookie"),e+=` paging-cookie="${t.pagingCookie}"`),e&&(t.fetchXml=t.fetchXml.replace(/^(<fetch)/,e))}return t.responseParameters={pageNumber:t.pageNumber},this._makeRequest(t).then((function(e){return e.data}))},this.fetchAll=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.fetchAll","request");const t=(e,r=[])=>this.fetch(e).then((function(a){return r=r.concat(a.value),a.PagingInfo?(e.pageNumber=a.PagingInfo.nextPage,e.pagingCookie=a.PagingInfo.cookie,t(e,r)):{value:r}}));return n.ErrorHelper.throwBatchIncompatible("DynamicsWebApi.fetchAll",this._isBatch),t(e)},this.associate=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.associate","request");const t=i.Utility.copyObject(e);t.method="POST",t.functionName="associate",n.ErrorHelper.stringParameterCheck(e.relatedCollection,"DynamicsWebApi.associate","request.relatedcollection"),n.ErrorHelper.stringParameterCheck(e.relationshipName,"DynamicsWebApi.associate","request.relationshipName");const r=n.ErrorHelper.keyParameterCheck(e.primaryKey,"DynamicsWebApi.associate","request.primaryKey"),a=n.ErrorHelper.keyParameterCheck(e.relatedKey,"DynamicsWebApi.associate","request.relatedKey");return t.navigationProperty=e.relationshipName+"/$ref",t.key=r,t.data={"@odata.id":`${e.relatedCollection}(${a})`},this._makeRequest(t).then((()=>{}))},this.disassociate=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.disassociate","request");const t=i.Utility.copyObject(e);t.method="DELETE",t.functionName="disassociate",n.ErrorHelper.stringParameterCheck(e.relationshipName,"DynamicsWebApi.disassociate","request.relationshipName");const r=n.ErrorHelper.keyParameterCheck(e.primaryKey,"DynamicsWebApi.disassociate","request.primaryKey"),a=n.ErrorHelper.keyParameterCheck(e.relatedKey,"DynamicsWebApi.disassociate","request.relatedId");return t.key=r,t.navigationProperty=`${e.relationshipName}(${a})/$ref`,this._makeRequest(t).then((()=>{}))},this.associateSingleValued=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.associateSingleValued","request");const t=i.Utility.copyObject(e);t.method="PUT",t.functionName="associateSingleValued";const r=n.ErrorHelper.keyParameterCheck(e.primaryKey,"DynamicsWebApi.associateSingleValued","request.primaryKey"),a=n.ErrorHelper.keyParameterCheck(e.relatedKey,"DynamicsWebApi.associateSingleValued","request.relatedKey");return n.ErrorHelper.stringParameterCheck(e.navigationProperty,"DynamicsWebApi.associateSingleValued","request.navigationProperty"),n.ErrorHelper.stringParameterCheck(e.relatedCollection,"DynamicsWebApi.associateSingleValued","request.relatedcollection"),t.navigationProperty+="/$ref",t.key=r,t.data={"@odata.id":`${e.relatedCollection}(${a})`},this._makeRequest(t).then((()=>{}))},this.disassociateSingleValued=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.disassociateSingleValued","request");const t=i.Utility.copyObject(e);t.method="DELETE",t.functionName="disassociateSingleValued";const r=n.ErrorHelper.keyParameterCheck(e.primaryKey,"DynamicsWebApi.disassociateSingleValued","request.primaryKey");return n.ErrorHelper.stringParameterCheck(e.navigationProperty,"DynamicsWebApi.disassociateSingleValued","request.navigationProperty"),t.navigationProperty+="/$ref",t.key=r,this._makeRequest(t).then((()=>{}))},this.executeUnboundFunction=e=>this._executeFunction(e,!0),this.executeBoundFunction=e=>this._executeFunction(e),this._executeFunction=(e,t=!1)=>{const r=t?"executeUnboundFunction":"executeBoundFunction";n.ErrorHelper.parameterCheck(e,`DynamicsWebApi.${r}`,"request"),n.ErrorHelper.stringParameterCheck(e.functionName,`DynamicsWebApi.${r}`,"request.functionName");const a=i.Utility.copyObject(e);return a.method="GET",a.functionName=r,a._additionalUrl=e.functionName+i.Utility.buildFunctionParameters(e.parameters),a._isUnboundRequest=t,a.key=e.id,this._makeRequest(a).then((function(e){return e.data}))},this.executeUnboundAction=e=>this._executeAction(e,!0),this.executeBoundAction=e=>this._executeAction(e),this._executeAction=(e,t=!1)=>{const r=t?"executeUnboundAction":"executeBoundAction";n.ErrorHelper.parameterCheck(e,`DynamicsWebApi.${r}`,"request"),n.ErrorHelper.stringParameterCheck(e.actionName,`DynamicsWebApi.${r}`,"request.actionName");const a=i.Utility.copyObject(e);return a.method="POST",a.functionName=r,a._additionalUrl=e.actionName,a._isUnboundRequest=t,a.key=e.id,a.data=e.action,this._makeRequest(a).then((e=>e.data))},this.createEntity=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.createEntity","request"),n.ErrorHelper.parameterCheck(e.data,"DynamicsWebApi.createEntity","request.data");const t=i.Utility.copyObject(e);return t.collection="EntityDefinitions",t.functionName="createEntity",this.create(t)},this.updateEntity=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.updateEntity","request"),n.ErrorHelper.parameterCheck(e.data,"DynamicsWebApi.updateEntity","request.data"),n.ErrorHelper.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateEntity","request.data.MetadataId");const t=i.Utility.copyObject(e);return t.collection="EntityDefinitions",t.key=t.data.MetadataId,t.functionName="updateEntity",t.method="PUT",this.update(t)},this.retrieveEntity=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.retrieveEntity","request"),n.ErrorHelper.keyParameterCheck(e.key,"DynamicsWebApi.retrieveEntity","request.key");const t=i.Utility.copyObject(e);return t.collection="EntityDefinitions",t.functionName="retrieveEntity",this.retrieve(t)},this.retrieveEntities=e=>{const t=e?i.Utility.copyObject(e):{};return t.collection="EntityDefinitions",t.functionName="retrieveEntities",this.retrieveMultiple(t)},this.createAttribute=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.createAttribute","request"),n.ErrorHelper.parameterCheck(e.data,"DynamicsWebApi.createAttribute","request.data"),n.ErrorHelper.keyParameterCheck(e.entityKey,"DynamicsWebApi.createAttribute","request.entityKey");const t=i.Utility.copyObject(e);return t.collection="EntityDefinitions",t.functionName="retrieveEntity",t.navigationProperty="Attributes",t.key=e.entityKey,this.create(t)},this.updateAttribute=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.updateAttribute","request"),n.ErrorHelper.parameterCheck(e.data,"DynamicsWebApi.updateAttribute","request.data"),n.ErrorHelper.keyParameterCheck(e.entityKey,"DynamicsWebApi.updateAttribute","request.entityKey"),n.ErrorHelper.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateAttribute","request.data.MetadataId"),e.castType&&n.ErrorHelper.stringParameterCheck(e.castType,"DynamicsWebApi.updateAttribute","request.castType");const t=i.Utility.copyObject(e);return t.collection="EntityDefinitions",t.navigationProperty="Attributes",t.navigationPropertyKey=e.data.MetadataId,t.metadataAttributeType=e.castType,t.key=e.entityKey,t.functionName="updateAttribute",t.method="PUT",this.update(t)},this.retrieveAttributes=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.retrieveAttributes","request"),n.ErrorHelper.keyParameterCheck(e.entityKey,"DynamicsWebApi.retrieveAttributes","request.entityKey"),e.castType&&n.ErrorHelper.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveAttributes","request.castType");const t=i.Utility.copyObject(e);return t.collection="EntityDefinitions",t.navigationProperty="Attributes",t.metadataAttributeType=e.castType,t.key=e.entityKey,t.functionName="retrieveAttributes",this.retrieveMultiple(t)},this.retrieveAttribute=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.retrieveAttributes","request"),n.ErrorHelper.keyParameterCheck(e.entityKey,"DynamicsWebApi.retrieveAttribute","request.entityKey"),n.ErrorHelper.keyParameterCheck(e.attributeKey,"DynamicsWebApi.retrieveAttribute","request.attributeKey"),e.castType&&n.ErrorHelper.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveAttribute","request.castType");const t=i.Utility.copyObject(e);return t.collection="EntityDefinitions",t.navigationProperty="Attributes",t.navigationPropertyKey=e.attributeKey,t.metadataAttributeType=e.castType,t.key=e.entityKey,t.functionName="retrieveAttribute",this.retrieve(t)},this.createRelationship=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.createRelationship","request"),n.ErrorHelper.parameterCheck(e.data,"DynamicsWebApi.createRelationship","request.data");const t=i.Utility.copyObject(e);return t.collection="RelationshipDefinitions",t.functionName="createRelationship",this.create(t)},this.updateRelationship=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.updateRelationship","request"),n.ErrorHelper.parameterCheck(e.data,"DynamicsWebApi.updateRelationship","request.data"),n.ErrorHelper.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateRelationship","request.data.MetadataId"),e.castType&&n.ErrorHelper.stringParameterCheck(e.castType,"DynamicsWebApi.updateRelationship","request.castType");const t=i.Utility.copyObject(e);return t.collection="RelationshipDefinitions",t.key=e.data.MetadataId,t.navigationProperty=e.castType,t.functionName="updateRelationship",t.method="PUT",this.update(t)},this.deleteRelationship=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.deleteRelationship","request"),n.ErrorHelper.keyParameterCheck(e.key,"DynamicsWebApi.deleteRelationship","request.key");const t=i.Utility.copyObject(e);return t.collection="RelationshipDefinitions",t.functionName="deleteRelationship",this.deleteRecord(t)},this.retrieveRelationships=e=>{const t=e?i.Utility.copyObject(e):{};return t.collection="RelationshipDefinitions",t.functionName="retrieveRelationships",e&&e.castType&&(n.ErrorHelper.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveRelationships","request.castType"),t.navigationProperty=e.castType),this.retrieveMultiple(t)},this.retrieveRelationship=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.retrieveRelationship","request"),n.ErrorHelper.keyParameterCheck(e.key,"DynamicsWebApi.retrieveRelationship","request.key"),e.castType&&n.ErrorHelper.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveRelationship","request.castType");const t=i.Utility.copyObject(e);return t.collection="RelationshipDefinitions",t.navigationProperty=e.castType,t.functionName="retrieveRelationship",this.retrieve(t)},this.createGlobalOptionSet=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.createGlobalOptionSet","request"),n.ErrorHelper.parameterCheck(e.data,"DynamicsWebApi.createGlobalOptionSet","request.data");const t=i.Utility.copyObject(e);return t.collection="GlobalOptionSetDefinitions",t.functionName="createGlobalOptionSet",this.create(t)},this.updateGlobalOptionSet=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.updateGlobalOptionSet","request"),n.ErrorHelper.parameterCheck(e.data,"DynamicsWebApi.updateGlobalOptionSet","request.data"),n.ErrorHelper.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateGlobalOptionSet","request.data.MetadataId"),e.castType&&n.ErrorHelper.stringParameterCheck(e.castType,"DynamicsWebApi.updateGlobalOptionSet","request.castType");const t=i.Utility.copyObject(e);return t.collection="GlobalOptionSetDefinitions",t.key=e.data.MetadataId,t.functionName="updateGlobalOptionSet",t.method="PUT",this.update(t)},this.deleteGlobalOptionSet=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.deleteGlobalOptionSet","request");const t=i.Utility.copyObject(e);return t.collection="GlobalOptionSetDefinitions",t.functionName="deleteGlobalOptionSet",this.deleteRecord(t)},this.retrieveGlobalOptionSet=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.retrieveGlobalOptionSet","request"),e.castType&&n.ErrorHelper.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveGlobalOptionSet","request.castType");const t=i.Utility.copyObject(e);return t.collection="GlobalOptionSetDefinitions",t.navigationProperty=e.castType,t.functionName="retrieveGlobalOptionSet",this.retrieve(t)},this.retrieveGlobalOptionSets=e=>{const t=e?i.Utility.copyObject(e):{};return t.collection="GlobalOptionSetDefinitions",t.functionName="retrieveGlobalOptionSets",(null==e?void 0:e.castType)&&(n.ErrorHelper.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveGlobalOptionSets","request.castType"),t.navigationProperty=e.castType),this.retrieveMultiple(t)},this.retrieveCsdlMetadata=e=>{const t=e?i.Utility.copyObject(e):{};return t.collection="$metadata",t.functionName="retrieveCsdlMetadata",(null==e?void 0:e.addAnnotations)&&(n.ErrorHelper.boolParameterCheck(e.addAnnotations,"DynamicsWebApi.retrieveCsdlMetadata","request.addAnnotations"),t.includeAnnotations="*"),this._makeRequest(t).then((e=>e.data))},this.search=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.search","request"),n.ErrorHelper.parameterCheck(e.query,"DynamicsWebApi.search","request.query"),n.ErrorHelper.stringParameterCheck(e.query.search,"DynamicsWebApi.search","request.query.search"),n.ErrorHelper.maxLengthStringParameterCheck(e.query.search,"DynamicsWebApi.search","request.query.search",100);const t=i.Utility.copyObject(e);return t.collection="query",t.functionName="search",t.method="POST",t.data=t.query,t.apiConfig=this._config.searchApi,delete t.query,this._makeRequest(t).then((e=>e.data))},this.suggest=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.suggest","request"),n.ErrorHelper.parameterCheck(e.query,"DynamicsWebApi.suggest","request.query"),n.ErrorHelper.stringParameterCheck(e.query.search,"DynamicsWebApi.suggest","request.query.search"),n.ErrorHelper.maxLengthStringParameterCheck(e.query.search,"DynamicsWebApi.suggest","request.query.search",100);const t=i.Utility.copyObject(e);return t.functionName=t.collection="suggest",t.method="POST",t.data=t.query,t.apiConfig=this._config.searchApi,delete t.query,this._makeRequest(t).then((e=>e.data))},this.autocomplete=e=>{n.ErrorHelper.parameterCheck(e,"DynamicsWebApi.autocomplete","request"),n.ErrorHelper.parameterCheck(e.query,"DynamicsWebApi.autocomplete","request.query"),n.ErrorHelper.stringParameterCheck(e.query.search,"DynamicsWebApi.autocomplete","request.query.search"),n.ErrorHelper.maxLengthStringParameterCheck(e.query.search,"DynamicsWebApi.autocomplete","request.query.search",100);const t=i.Utility.copyObject(e);return t.functionName=t.collection="autocomplete",t.method="POST",t.data=t.query,t.apiConfig=this._config.searchApi,delete t.query,this._makeRequest(t).then((e=>e.data))},this.startBatch=()=>{this._isBatch=!0,this._batchRequestId=i.Utility.generateUUID()},this.executeBatch=e=>{n.ErrorHelper.throwBatchNotStarted(this._isBatch);const t=e?i.Utility.copyObject(e):{};t.collection="$batch",t.method="POST",t.functionName="executeBatch",this._isBatch=!1;const r=this._makeRequest(t).then((function(e){return e.data}));return this._batchRequestId=null,r},this.initializeInstance=e=>new s(e||this._config),this.Utility={getCollectionName:e=>o.RequestClient.getCollectionName(e)},t.ConfigurationUtility.merge(this._config,e)}}e.DynamicsWebApi=s})(),a})()));